
    

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Laborator 03 - Procese    [CS Open CourseWare]
  </title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2022-03-02T09:31:42+0200"/>
<meta name="keywords" content="so,laboratoare,laborator-03"/>
<link rel="search" type="application/opensearchdescription+xml" href="/courses/lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="/courses/"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/courses/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="/courses/feed.php?mode=list&amp;ns=so:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="/courses/_export/xhtml/so/laboratoare/laborator-03"/>
<link rel="canonical" href="http://ocw.cs.pub.ro/courses/so/laboratoare/laborator-03"/>
<link rel="stylesheet" type="text/css" href="/courses/lib/exe/css.php?t=arctic&amp;tseed=1666014989"/>
<script type="text/javascript">/*<![CDATA[*/var NS='so:laboratoare';var JSINFO = {"id":"so:laboratoare:laborator-03","namespace":"so:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/courses/lib/exe/js.php?tseed=1666014989"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>

  <link rel="shortcut icon" href="/courses/lib/tpl/arctic/images/favicon.ico" />

  
</head>
<body>
<div id="wrapper" class='show'>
  <div class="dokuwiki">

    
    <div class="stylehead">
      <div class="header">
        <div class="pagename">
          <a href="/courses/so/"><img height="70" src="/courses//res/sigla_so.png"/> </a>        </div>
        <div class="logo">
          <a style="color: #AAA !important;" href="/courses/systems/"/><img height="70" src="/courses/res/systems.png" name="dokuwiki__top"/></a>        </div>
      </div>
    
       
      <div class="breadcrumbs">
              </div>
      
            </div>

                  <div class="bar" id="bar__top">
        <div class="bar-left">
                  </div>
        <div class="bar-right">
          <a href="/courses/so/laboratoare/laborator-03?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a><a href="/courses/so/laboratoare/laborator-03?do=login&amp;sectok=47c5d206dd300996c3e20b17d0af9305"  class="action login" rel="nofollow" title="Login">Login</a>        </div>
    </div>
        
    
    
    
              <div class="left_page">
          
<h1 class="sectionedit1" id="laborator_03_-_procese">Laborator 03 - Procese</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="materiale_ajutatoare">Materiale ajutătoare</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <a href="http://elf.cs.pub.ro/so/res/tutorial/lab-03-procese/" class="urlextern" title="http://elf.cs.pub.ro/so/res/tutorial/lab-03-procese/"  rel="nofollow">Video Procese</a></div>
</li>
</ul>

</div>

<h3 class="sectionedit3" id="nice_to_read">Nice to read</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> TLPI - Chapter 6, <code>Processes</code>, Chapter 26 <code>Monitoring Child Processes</code></div>
</li>
<li class="level1"><div class="li"> WSP4 - Chapter 6, <code>Process Management</code></div>
</li>
</ul>

</div>

<h2 class="sectionedit4" id="link-uri_catre_sectiuni_utile">Link-uri către secțiuni utile</h2>
<div class="level2">

</div>

<h3 class="sectionedit5" id="linux">Linux</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="#crearea_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Crearea unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#inlocuirea_imaginii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Înlocuirea imaginii unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#asteptarea_terminarii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Așteptarea terminării unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#terminarea_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Terminarea unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#exemplu_my_system" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Exemplu (my_system)</a></div>
</li>
<li class="level1"><div class="li"> <a href="#copierea_descriptorilor_de_fisier" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Copierea descriptorilor de fișier</a></div>
</li>
<li class="level1"><div class="li"> <a href="#mostenirea_descriptorilor_de_fisier_dupa_operatii_forkexec" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Moștenirea descriptorilor de fișier după operații fork/exec</a></div>
</li>
<li class="level1"><div class="li"> <a href="#variabile_de_mediu_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Variabile de mediu în Linux</a></div>
</li>
<li class="level1"><div class="li"> <a href="#pipe-uri_anonime_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri anonime în Linux</a></div>
</li>
<li class="level1"><div class="li"> <a href="#pipe-uri_cu_nume_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri cu nume în Linux</a> </div>
</li>
</ul>

</div>

<h3 class="sectionedit6" id="windows">Windows</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="#crearea_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Crearea unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#asteptarea_terminarii_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Așteptarea terminării unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#aflarea_codului_de_terminare_a_procesului_asteptat_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Aflarea codului de terminare a procesului așteptat</a></div>
</li>
<li class="level1"><div class="li"> <a href="#terminarea_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Terminarea unui proces</a></div>
</li>
<li class="level1"><div class="li"> <a href="#exemplu" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Exemplu</a></div>
</li>
<li class="level1"><div class="li"> <a href="#mostenirea_handle-urilor_la_createprocess" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Moștenirea handle-urilor la CreateProcess</a></div>
</li>
<li class="level1"><div class="li"> <a href="#variabile_de_mediu_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Variabile de mediu în Windows</a></div>
</li>
<li class="level1"><div class="li"> <a href="#pipe-uri_anonime_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri anonime în Windows</a></div>
</li>
<li class="level1"><div class="li"> <a href="#pipe-uri_cu_nume_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri cu nume în Windows</a></div>
</li>
</ul>

</div>

<h2 class="sectionedit7" id="prezentare_concepte">Prezentare concepte</h2>
<div class="level2">

<p>
Un <strong>proces</strong> este un program în execuție. Procesele sunt unitatea primitivă prin care sistemul de operare alocă resurse utilizatorilor. Orice proces are un spațiu de adrese și unul sau mai multe fire de execuție. Putem avea mai multe procese ce execută același program, dar oricare două procese sunt complet independente. 
</p>

<p>
Informațiile despre procese sunt ținute într-o structură numită <code>Process Control Block</code> (<a href="http://en.wikipedia.org/wiki/Process_control_block" class="urlextern" title="http://en.wikipedia.org/wiki/Process_control_block"  rel="nofollow">PCB</a>), câte una pentru fiecare proces existent în sistem. Printre cele mai importante informații conținute de PCB regăsim:
</p>
<ul>
<li class="level1"><div class="li">PID - identificatorul procesului</div>
</li>
<li class="level1"><div class="li">spațiu de adresă</div>
</li>
<li class="level1"><div class="li">registre generale, <code>PC</code> (contor program), <code>SP</code> (indicator stivă)</div>
</li>
<li class="level1"><div class="li">tabela de fișiere deschise</div>
</li>
<li class="level1"><div class="li"><a href="/courses/so/laboratoare-2013/laborator-06" class="wikilink1" title="so:laboratoare-2013:laborator-06">informații referitoare la semnale</a></div>
<ul>
<li class="level2"><div class="li">lista de semnale blocate, ignorate sau care așteaptă să fie trimise procesului</div>
</li>
<li class="level2"><div class="li">handler-ele de semnale</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">informațiile referitoare la sistemele de fișiere (directorul rădăcină, directorul curent) </div>
</li>
</ul>

<p>
În momentul lansării în execuție a unui program, în sistemul de operare se va crea un proces pentru alocarea resurselor necesare rulării programului respectiv. Fiecare sistem de operare pune la dispoziție apeluri de sistem pentru lucrul cu procese: creare, terminare, așteptarea terminării. Totodată există apeluri pentru duplicarea descriptorilor de resurse între procese, ori închiderea acestor descriptori.
</p>

<p>
Procesele pot avea o organizare:
</p>
<ul>
<li class="level1"><div class="li"><em>ierarhică</em> - de exemplu pe Linux - există o structură arborescentă în care rădăcina este procesul <code>init</code> (pid = 1).</div>
</li>
<li class="level1"><div class="li"><em>neierarhică</em> - de exemplu pe Windows.</div>
</li>
</ul>

<p>
În general, un proces rulează într-un mediu specificat printr-un set de <strong>variabile de mediu</strong>. O variabilă de mediu este o pereche <code>NUME = valoare</code>. Un proces poate să verifice sau să seteze valoarea unei variabile de mediu printr-o serie de apeluri de bibliotecă (<a href="#variabile_de_mediu_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Linux</a>, <a href="#variabile_de_mediu_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> Windows</a>).
</p>

<p>
<strong>Pipe-urile</strong> (canalele de comunicație) sunt mecanisme primitive de comunicare între procese. Un pipe poate conține o cantitate limitată de date. Accesul la aceste date este de tip FIFO (datele se scriu la un capăt al pipe-ului pentru a fi citite de la celălalt capăt). Sistemul de operare garantează sincronizarea între operațiile de citire și scriere la cele două capete
 (<a href="#pipe-uri_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Linux</a>, <a href="#pipe-uri_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> Windows</a>).
</p>

<p>
Există două tipuri de pipe-uri:
</p>
<ul>
<li class="level1"><div class="li">pipe-uri <strong>anonime</strong>: pot fi folosite doar de procese <strong>înrudite</strong> (un proces părinte și un copil sau doi copii), deoarece sunt accesibile doar prin moștenire. Aceste pipe-uri nu mai există după ce procesele și-au terminat execuția.</div>
</li>
<li class="level1"><div class="li">pipe-uri <strong>cu nume</strong>: au suport fizic - există ca fișiere cu drepturi de acces. Prin urmare, ele vor exista independent de procesul care le creează și pot fi folosite de procese neînrudite. </div>
</li>
</ul>

</div>

<h2 class="sectionedit8" id="procese_in_linux">Procese în Linux</h2>
<div class="level2">

<p>
Lansarea în execuție a unui program presupune următorii pași:
</p>
<ul>
<li class="level1"><div class="li">Se creează un nou proces cu <code>fork</code> - procesul copil are o copie a resurselor procesului părinte. </div>
</li>
<li class="level1"><div class="li">Dacă se dorește înlocuirea imaginii procesului copil aceasta poate fi schimbată prin apelarea unei funcții din familia <code>exec*</code>.</div>
</li>
</ul>

</div>

<h3 class="sectionedit9" id="crearea_unui_proces_in_linux">Crearea unui proces în Linux</h3>
<div class="level3">

<p>
În UNIX un proces se creează folosind apelul de sistem <a href="http://linux.die.net/man/2/fork" class="urlextern" title="http://linux.die.net/man/2/fork"  rel="nofollow">fork</a>:
</p>
<pre class="code c">pid_t fork<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Efectul este crearea unui nou proces (procesul copil), copie a celui care a apelat <code>fork</code> (procesul părinte). Procesul copil primește un nou <em>process id</em> (<code>PID</code>) de la sistemul de operare. 
</p>

<p>
<p><div class="noteimportant"> Această funcție este apelată o dată și se întoarce (în caz de succes) de două ori:
</p>
<ul>
<li class="level1"><div class="li">În părinte va întoarce pid-ul procesului nou creat (copil).</div>
</li>
<li class="level1"><div class="li">În procesul copil apelul va întoarce 0.</div>
</li>
</ul>

<p>

</div></p>
</p>

<p>
<a href="/courses/_detail/so/laboratoare/fork.png?id=so%3Alaboratoare%3Alaborator-03" class="media" title="so:laboratoare:fork.png"><img src="/courses/_media/so/laboratoare/fork.png?w=300&amp;tok=fa2f6d" class="mediaright" alt="" width="300" /></a>
</p>

<p>
Pentru aflarea <code>PID</code>-ului procesului curent și al procesului părinte se vor apela funcțiile de mai jos.
</p>

<p>
Funcția <a href="http://linux.die.net/man/3/getpid" class="urlextern" title="http://linux.die.net/man/3/getpid"  rel="nofollow">getpid</a> întoarce <code>PID</code>-ul procesului apelant:
</p>
<pre class="code c">pid_t getpid<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Funcția <a href="http://linux.die.net/man/3/getppid" class="urlextern" title="http://linux.die.net/man/3/getppid"  rel="nofollow">getppid</a> întoarce <code>PID</code>-ul procesului părinte al procesului apelant:
</p>
<pre class="code c">pid_t getppid<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit10" id="inlocuirea_imaginii_unui_proces_in_linux">Înlocuirea imaginii unui proces în Linux</h3>
<div class="level3">

<p>
Familia de funcții <a href="http://linux.die.net/man/3/exec" class="urlextern" title="http://linux.die.net/man/3/exec"  rel="nofollow">exec</a> va executa un nou program, înlocuind imaginea procesului curent, cu cea dintr-un fișier (executabil). Acest lucru înseamnă:
</p>
<ul>
<li class="level1"><div class="li"> Spațiul de adrese al procesului va fi înlocuit cu unul nou, creat special pentru execuția fișierului.</div>
</li>
<li class="level1"><div class="li"> Registrele <code>PC</code> (contorul program), <code>SP</code> (indicatorul stivă) și registrele generale vor fi reinițializate. </div>
</li>
<li class="level1"><div class="li"> Măștile de semnale ignorate și blocate sunt setate la valorile implicite, ca și handler-ele semnalelor. </div>
</li>
<li class="level1"><div class="li"> <code>PID</code>-ul și descriptorii de fișier care nu au setat flag-ul <code>CLOSE_ON_EXEC</code> rămân neschimbați (implicit, flag-ul <code>CLOSE_ON_EXEC</code> nu este setat).</div>
</li>
</ul>
<pre class="code c"><span class="kw4">int</span> execl<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>path<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>arg<span class="sy0">,</span> ...<span class="br0">&#41;</span><span class="sy0">;</span> 
<span class="kw4">int</span> execv<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>path<span class="sy0">,</span> <span class="kw4">char</span> <span class="sy0">*</span><span class="kw4">const</span> argv<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw4">int</span> execlp<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>file<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>arg<span class="sy0">,</span> ...<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Exemplu de folosire a funcțiilor de mai sus:
</p>
<pre class="code c">execl<span class="br0">&#40;</span><span class="st0">&quot;/bin/ls&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ls&quot;</span><span class="sy0">,</span> <span class="st0">&quot;-la&quot;</span><span class="sy0">,</span> NULL<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw4">char</span> <span class="sy0">*</span><span class="kw4">const</span> argvec<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span><span class="st0">&quot;ls&quot;</span><span class="sy0">,</span> <span class="st0">&quot;-la&quot;</span><span class="sy0">,</span> NULL<span class="br0">&#125;</span><span class="sy0">;</span>
execv<span class="br0">&#40;</span><span class="st0">&quot;/bin/ls&quot;</span><span class="sy0">,</span> argvec<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
execlp<span class="br0">&#40;</span><span class="st0">&quot;ls&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ls&quot;</span><span class="sy0">,</span> <span class="st0">&quot;-la&quot;</span><span class="sy0">,</span> NULL<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<p><div class="noteimportant"> Primul argument este numele programului. Ultimul argument al listei de parametri trebuie să fie NULL, indiferent dacă lista este sub formă de vector (execv*) sau sub formă de argumente variabile (execl*).

</div></p>
</p>

<p>
<code>execl</code> și <code>execv</code> nu caută programul dat ca parametru în <code>PATH</code>, astfel că acesta trebuie însoțit de calea completă. Versiunile <code>execlp</code> și <code>execvp</code> caută programul și în <code>PATH</code>.
</p>

<p>
Toate funcțiile <code>exec*</code> sunt implementate prin apelul de sistem <a href="http://linux.die.net/man/2/execve" class="urlextern" title="http://linux.die.net/man/2/execve"  rel="nofollow">execve</a>.
</p>

</div>

<h3 class="sectionedit11" id="asteptarea_terminarii_unui_proces_in_linux">Așteptarea terminării unui proces în Linux</h3>
<div class="level3">

<p>
Familia de funcții <a href="http://linux.die.net/man/3/waitpid" class="urlextern" title="http://linux.die.net/man/3/waitpid"  rel="nofollow">wait</a> suspendă execuția procesului apelant până când procesul (procesele) specificat în argumente fie s-a terminat, fie a fost oprit (<code>SIGSTOP</code>).
</p>
<pre class="code c">pid_t waitpid<span class="br0">&#40;</span>pid_t pid<span class="sy0">,</span> <span class="kw4">int</span> <span class="sy0">*</span>status<span class="sy0">,</span> <span class="kw4">int</span> options<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Starea procesului interogat se poate afla examinând <code>status</code> cu macrodefiniții precum <a href="http://linux.die.net/man/3/waitpid" class="urlextern" title="http://linux.die.net/man/3/waitpid"  rel="nofollow">WEXITSTATUS</a>, care întoarce codul de eroare cu care s-a încheiat procesul așteptat, evaluând cei mai nesemnificativi 8 biți. 
</p>

<p>
Există o variantă simplificată, care așteaptă orice proces copil să se termine. Următoarele secvențe de cod sunt echivalente:
</p>
<pre class="code c">wait<span class="br0">&#40;</span><span class="sy0">&amp;</span>status<span class="br0">&#41;</span><span class="sy0">;</span>                   <span class="sy0">|</span>  waitpid<span class="br0">&#40;</span><span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span> <span class="sy0">&amp;</span>status<span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
În caz că se dorește doar așteptarea terminării procesului copil, nu și examinarea statusului, se poate folosi:
</p>
<pre class="code c">wait<span class="br0">&#40;</span>NULL<span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit12" id="terminarea_unui_proces_in_linux">Terminarea unui proces în Linux</h3>
<div class="level3">

<p>
Pentru terminarea procesului curent, Linux pune la dispoziție apelul de sistem <code>exit</code>. 
</p>
<pre class="code c"><span class="kw4">void</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="br0">&#40;</span><span class="kw4">int</span> status<span class="br0">&#41;</span><span class="sy0">;</span></pre>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Apeluri exit
</p>
</div><div class="hiddenOnVisible">
<p>
Apeluri exit
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Dintr-un program <code>C</code> există trei moduri de invocare a acestui apel de sistem:
</p>

<p>
1. apelul <a href="http://linux.die.net/man/2/exit" class="urlextern" title="http://linux.die.net/man/2/exit"  rel="nofollow">_exit</a> (<a href="http://linux.die.net/man/7/standards" class="urlextern" title="http://linux.die.net/man/7/standards"  rel="nofollow">POSIX.1-2001</a>): 
</p>
<pre class="code c"><span class="kw4">void</span> _exit<span class="br0">&#40;</span><span class="kw4">int</span> status<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
2. apelul <a href="http://linux.die.net/man/2/exit" class="urlextern" title="http://linux.die.net/man/2/exit"  rel="nofollow">_Exit</a> din biblioteca standard <code>C</code> (conform <a href="http://en.wikipedia.org/wiki/C99" class="urlextern" title="http://en.wikipedia.org/wiki/C99"  rel="nofollow">C99</a>): 
</p>
<pre class="code c"><span class="kw4">void</span> _Exit<span class="br0">&#40;</span><span class="kw4">int</span> status<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
3. apelul <a href="http://linux.die.net/man/3/exit" class="urlextern" title="http://linux.die.net/man/3/exit"  rel="nofollow">exit</a> din biblioteca standard <code>C</code> (conform <code>C89</code>, <code>C99</code>), cel prezentat mai sus.
</p>

<p>
<code>_exit(2)</code> și <code>_Exit(2)</code> sunt funcțional echivalente (doar că sunt definite de standarde diferite):
</p>
<ul>
<li class="level1"><div class="li"> procesul apelant se va termina imediat</div>
</li>
<li class="level1"><div class="li"> toți descriptorii de fișier ai procesului sunt închiși</div>
</li>
<li class="level1"><div class="li"> copiii procesului sunt “înfiați” de <code>init</code></div>
</li>
<li class="level1"><div class="li"> un semnal <code>SIGCHLD</code> va fi trimis către părintele procesului. Tot acestuia îi va fi întoarsă valoarea <code>status</code>, ca rezultat al unei funcții de așteptare (<code>wait</code> sau <code>waitpid</code>). </div>
</li>
</ul>

<p>
În plus, <code>exit(3)</code>:
</p>
<ul>
<li class="level1"><div class="li"> va șterge toate fișierele create cu <code>tmpfile()</code></div>
</li>
<li class="level1"><div class="li"> va scrie bufferele streamurilor deschise și le va închide</div>
</li>
</ul>
</div></div>
<p>
<p><div class="noteclassic"> Conform <code>ISO C</code>, un program care se termină cu <code>return x</code> din <code>main()</code> va avea același comportament ca unul care apelează <code>exit(x)</code>. 
</div></p>
</p>

<p>
Un proces al cărui părinte s-a terminat poartă numele de <strong>proces orfan</strong>. Acest proces este adoptat automat de către procesul <code>init</code>, dar poartă denumirea de orfan în continuare deoarece procesul care l-a creat inițial nu mai există. În acest context, procesul <code>init</code> implementează funcționalitatea de <strong>child reaper</strong>.
</p>

<p>
<p><div class="noteclassic">
Pe distribuțiile de Linux recente, funcționalitatea de child reaper poate fi implementată și de alte procese din sistem, precum <code>systemd</code>.

</div></p>
</p>

<p>
Un proces finalizat al cărui părinte nu a citit (încă) statusul terminării acestuia poartă numele de <strong>proces zombie</strong>. Procesul intră într-o stare de terminare, iar informația continuă să existe în tabela de procese astfel încât să ofere părintelui posibilitatea de a verifica codul cu care s-a finalizat procesul. În momentul în care părintele apelează funcția <code>wait</code>, informația despre proces dispare. Orice proces copil o să treacă prin starea de proces zombie la terminare.
</p>

<p>
Pentru terminarea unui alt proces din sistem, se va trimite un semnal către procesul respectiv prin intermediul apelului de sistem <a href="http://linux.die.net/man/2/kill" class="urlextern" title="http://linux.die.net/man/2/kill"  rel="nofollow">kill</a>. Mai multe detalii despre <code>kill</code> și  semnale în<a href="/courses/so/laboratoare-2013/laborator-06" class="wikilink1" title="so:laboratoare-2013:laborator-06">  laboratorul de semnale</a>.
</p>

</div>

<h3 class="sectionedit13" id="exemplu_my_system">Exemplu (my_system)</h3>
<div class="level3">
<dl class="code">
<dt><a href="/courses/_export/code/so/laboratoare/laborator-03?codeblock=11" title="Download Snippet" class="mediafile mf_c">my_system.c</a></dt>
<dd><pre class="code c"><span class="co2">#include &lt;stdlib.h&gt;</span>
<span class="co2">#include &lt;stdio.h&gt;</span>
&nbsp;
<span class="co2">#include &lt;sys/types.h&gt;</span>
<span class="co2">#include &lt;sys/wait.h&gt;</span>
<span class="co2">#include &lt;unistd.h&gt;</span>
&nbsp;
<span class="kw4">int</span> my_system<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>command<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	pid_t pid<span class="sy0">;</span>
	<span class="kw4">int</span> status<span class="sy0">;</span>
	<span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>argv<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span>command<span class="sy0">,</span> NULL<span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;
	pid <span class="sy0">=</span> fork<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
	<span class="kw1">switch</span> <span class="br0">&#40;</span>pid<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">case</span> <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">:</span>
		<span class="coMULTI">/* error forking */</span>
		<span class="kw1">return</span> EXIT_FAILURE<span class="sy0">;</span>
	<span class="kw1">case</span> <span class="nu0">0</span><span class="sy0">:</span>
		<span class="coMULTI">/* child process */</span>
		execvp<span class="br0">&#40;</span>command<span class="sy0">,</span> <span class="br0">&#40;</span><span class="kw4">char</span> <span class="sy0">*</span><span class="kw4">const</span> <span class="sy0">*</span><span class="br0">&#41;</span> argv<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
		<span class="coMULTI">/* only if exec failed */</span>
		<a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="br0">&#40;</span>EXIT_FAILURE<span class="br0">&#41;</span><span class="sy0">;</span>
	<span class="kw1">default</span><span class="sy0">:</span>
		<span class="coMULTI">/* parent process */</span>
		<span class="kw2">break</span><span class="sy0">;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="coMULTI">/* only parent process gets here */</span>
	waitpid<span class="br0">&#40;</span>pid<span class="sy0">,</span> <span class="sy0">&amp;</span>status<span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>WIFEXITED<span class="br0">&#40;</span>status<span class="br0">&#41;</span><span class="br0">&#41;</span>
		<a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;Child %d terminated normally, with code %d<span class="es1">\n</span>&quot;</span><span class="sy0">,</span>
			pid<span class="sy0">,</span> WEXITSTATUS<span class="br0">&#40;</span>status<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
	<span class="kw1">return</span> status<span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
	my_system<span class="br0">&#40;</span><span class="st0">&quot;ls&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
	<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</dd></dl>

</div>

<h3 class="sectionedit14" id="copierea_descriptorilor_de_fisier">Copierea descriptorilor de fișier</h3>
<div class="level3">

<p>
<a href="http://linux.die.net/man/2/dup" class="urlextern" title="http://linux.die.net/man/2/dup"  rel="nofollow">dup</a> duplică descriptorul de fișier <code>oldfd</code> și întoarce noul descriptor de fișier, sau <code>-1</code> în caz de eroare:
</p>
<pre class="code c"><span class="kw4">int</span> dup<span class="br0">&#40;</span><span class="kw4">int</span> oldfd<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<a href="http://linux.die.net/man/2/dup" class="urlextern" title="http://linux.die.net/man/2/dup"  rel="nofollow">dup2</a> duplică descriptorul de fișier <code>oldfd</code> în descriptorul de fișier <code>newfd</code>; dacă <code>newfd</code> există, mai întâi va fi închis. Întoarce noul descriptor de fișier, sau <code>-1</code> în caz de eroare:
</p>
<pre class="code c"><span class="kw4">int</span> dup2<span class="br0">&#40;</span><span class="kw4">int</span> oldfd<span class="sy0">,</span> <span class="kw4">int</span> newfd<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Descriptorii de fișier sunt, de fapt, indecși în tabela de fișiere deschise. Tabela este populată cu pointeri către structuri cu informațiile despre fișiere. Duplicarea unui descriptor de fișier înseamnă duplicarea intrării din tabela de fișiere deschise (adică 2 pointeri de la poziții diferite din tabelă vor indica spre aceeași structură din sistem, asociată fișierului). Din acest motiv, toate informațiile asociate unui fișier (lock-uri, cursor, flag-uri) sunt <strong>partajate</strong> de cei doi file descriptori. Aceasta înseamnă că operațiile ce modifică aceste informații pe unul dintre file descriptori (de ex. <code>lseek</code>) sunt vizibile și pentru celălalt file descriptor (duplicat).
</p>

<p>
<p><div class="noteimportant"> Flag-ul <code>CLOSE_ON_EXEC</code> nu este partajat (acest flag nu este ținut în structura menționată mai sus). 
</div></p>
</p>

</div>

<h4 id="mostenirea_descriptorilor_de_fisier_dupa_operatii_forkexec">Moștenirea descriptorilor de fișier după operații fork/exec</h4>
<div class="level4">

<p>
Descriptorii de fișier ai procesului părinte se <strong>moștenesc</strong> în procesul copil în urma apelului <code>fork</code>. După un apel <code>exec</code>, descriptorii de fișier sunt păstrați, excepție făcând cei care au flag-ul <code>CLOSE_ON_EXEC</code> setat.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Detalii despre flagul CLOSE_ON_EXEC
</p>
</div><div class="hiddenOnVisible">
<p>
Detalii despre flagul CLOSE_ON_EXEC
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<strong>fcntl</strong>
</p>

<p>
Pentru a seta flag-ul <code>CLOSE_ON_EXEC</code> se folosește funcția <a href="http://linux.die.net/man/3/fcntl" class="urlextern" title="http://linux.die.net/man/3/fcntl"  rel="nofollow">fcntl</a>, cu un apel de forma:
</p>
<pre class="code c">fcntl<span class="br0">&#40;</span>file_descriptor<span class="sy0">,</span> F_SETFD<span class="sy0">,</span> FD_CLOEXEC<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<strong>O_CLOEXEC</strong>
</p>

<p>
<code>fcntl</code> poate activa flag-ul <code>FD_CLOEXEC</code> doar pentru descriptori de fișier deja existenți. În aplicații cu mai multe fire de execuție, între crearea unui descriptor de fișier și un apel <code>fcntl</code> se poate interpune un apel <code>exec</code> pe un alt fir de execuție.
</p>
<pre class="code C"><span class="sy0">/</span> <span class="sy0">*</span> THREAD <span class="nu0">1</span> <span class="sy0">*/</span>                   <span class="sy0">|/</span> <span class="sy0">*</span> THREAD <span class="nu0">2</span> <span class="sy0">*/</span>    
fd <span class="sy0">=</span> op_creare_fd<span class="br0">&#40;</span><span class="br0">&#41;</span>               <span class="sy0">|</span>
                                  <span class="sy0">|</span> exec<span class="br0">&#40;</span>...<span class="br0">&#41;</span>
fcntl<span class="br0">&#40;</span>fd<span class="sy0">,</span> F_SETFD<span class="sy0">,</span> FD_CLOEXEC<span class="br0">&#41;</span><span class="sy0">;</span>   <span class="sy0">|</span></pre>

<p>
Cum, implicit, descriptorii de fișiere sunt moșteniți după un apel <code>exec</code>, deși programatorul a dorit ca acesta să nu poată fi accesat după <code>exec</code>, nu poate preveni apariția unui apel <code>exec</code> între creare și <code>fcntl</code>.
</p>

<p>
Pentru a rezolva această condiție de cursă, s-au introdus în Linux 2.6.27 (2008) versiuni noi ale unor apeluri de sistem:
</p>
<pre class="code C"><span class="kw4">int</span> dup3<span class="br0">&#40;</span><span class="kw4">int</span> oldfd<span class="sy0">,</span> <span class="kw4">int</span> newfd<span class="sy0">,</span> <span class="kw4">int</span> flags<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw4">int</span> pipe2<span class="br0">&#40;</span><span class="kw4">int</span> pipefd<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="kw4">int</span> flags<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw4">int</span> accept4<span class="br0">&#40;</span><span class="kw4">int</span> sockfd<span class="sy0">,</span> <span class="kw4">struct</span> sockaddr <span class="sy0">*</span>addr<span class="sy0">,</span> socklen_t <span class="sy0">*</span>addrlen<span class="sy0">,</span> <span class="kw4">int</span> flags<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Aceste variante ale apelurilor de sistem adaugă câmpul <code>flags</code>, prin care se poate specifica <code>O_CLOEXEC</code>, pentru a crea și activa <code>CLOSE_ON_EXEC</code> în mod <em>atomic</em>. Numărul din numele apelului de sistem, specifică numărul de parametri ai apelului.
</p>

<p>
Apelurile de sistem care creează descriptori de fișiere care primeau deja un parametru <code>flags</code> (e.g. <code>open</code>) au fost doar extinse să accepte și <code>O_CLOEXEC</code>.
</p>
</div></div>
</div>

<h2 class="sectionedit15" id="variabile_de_mediu_in_linux">Variabile de mediu în Linux</h2>
<div class="level2">

<p>
În cadrul unui program se pot accesa variabilele de mediu, prin evidențierea celui de-al treilea parametru (opțional) al funcției <code>main</code>, ca în exemplul următor:
</p>
<pre class="code c"><span class="kw4">int</span> main<span class="br0">&#40;</span><span class="kw4">int</span> argc<span class="sy0">,</span> <span class="kw4">char</span> <span class="sy0">**</span>argv<span class="sy0">,</span> <span class="kw4">char</span> <span class="sy0">**</span>environ<span class="br0">&#41;</span></pre>

<p>
Acesta desemnează un vector de pointeri la șiruri de caractere, ce conțin variabilele de mediu și valorile lor. Șirurile de caractere sunt de forma <code>VARIABILA=VALOARE</code>. Vectorul e terminat cu <code>NULL</code>. 
</p>

<p>
<a href="http://linux.die.net/man/3/getenv" class="urlextern" title="http://linux.die.net/man/3/getenv"  rel="nofollow">getenv</a> întoarce valoarea variabilei de mediu denumite <code>name</code>, sau <code>NULL</code> dacă nu există o variabilă de mediu denumită astfel:
</p>
<pre class="code c"><span class="kw4">char</span><span class="sy0">*</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/getenv.html"><span class="kw3">getenv</span></a><span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>name<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<a href="http://linux.die.net/man/3/setenv" class="urlextern" title="http://linux.die.net/man/3/setenv"  rel="nofollow">setenv</a> adaugă în mediu variabila cu numele <code>name</code> (dacă nu există deja) și îi setează valoarea la <code>value</code>. Dacă variabila există și <code>replace</code> e <code>0</code>, acțiunea de setare a valorii variabilei e ignorată; dacă <code>replace</code> e diferit de <code>0</code>, valoarea variabilei devine <code>value</code>:
</p>
<pre class="code c"><span class="kw4">int</span> setenv<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>name<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>value<span class="sy0">,</span> <span class="kw4">int</span> replace<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<a href="http://linux.die.net/man/3/unsetenv" class="urlextern" title="http://linux.die.net/man/3/unsetenv"  rel="nofollow">unsetenv</a> șterge din mediu variabila denumită <code>name</code>:
</p>
<pre class="code c"><span class="kw4">int</span> unsetenv<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>name<span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit16" id="pipe-uri_in_linux">Pipe-uri în Linux</h2>
<div class="level2">

</div>

<h3 class="sectionedit17" id="pipe-uri_anonime_in_linux">Pipe-uri anonime în Linux</h3>
<div class="level3">

<p>
Pipe-ul este un mecanism de comunicare unidirecțională între două procese. În majoritatea implementărilor de UNIX, un pipe apare ca o zonă de memorie de o anumită dimensiune în spațiul nucleului. Procesele care comunică printr-un pipe anonim trebuie să aibă un grad de rudenie; de obicei, un proces care creează un pipe va apela după aceea <code>fork</code>, iar pipe-ul se va folosi pentru comunicarea între părinte și fiu. În orice caz, procesele care comunică prin pipe-uri anonime nu pot fi create de utilizatori diferiți ai sistemului.
</p>

<p>
Apelul de sistem pentru creare este <a href="http://linux.die.net/man/2/pipe" class="urlextern" title="http://linux.die.net/man/2/pipe"  rel="nofollow">pipe</a>:
</p>

<p>
<a href="/courses/_detail/so/laboratoare/pipe.png?id=so%3Alaboratoare%3Alaborator-03" class="media" title="so:laboratoare:pipe.png"><img src="/courses/_media/so/laboratoare/pipe.png?w=370&amp;tok=dd9575" class="mediaright" title=" Exemplu de utilizare - procesul părinte transmite date procesului copil prin pipe" alt=" Exemplu de utilizare - procesul părinte transmite date procesului copil prin pipe" width="370" /></a>
</p>
<pre class="code c"><span class="kw4">int</span> pipe<span class="br0">&#40;</span><span class="kw4">int</span> filedes<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Vectorul <code>filedes</code> conține după execuția funcției 2 descriptori de fișier:
</p>
<ul>
<li class="level1"><div class="li"><code>filedes[0]</code>, deschis pentru citire; </div>
</li>
<li class="level1"><div class="li"><code>filedes[1]</code>, deschis pentru scriere;</div>
</li>
</ul>



<p>
<em>Mnemotehnică</em>: <code>STDIN_FILENO</code> este 0 (citire), <code>STDOUT_FILENO</code> este 1 (scriere).
</p>

<p>
<strong>Observații</strong>:
</p>
<ul>
<li class="level1"><div class="li">citirea/scrierea din/în pipe-uri este atomică dacă nu se citesc/scriu mai mult de <code>PIPE_BUF</code><sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup> octeți. </div>
</li>
<li class="level1"><div class="li">citirea/scrierea din/în pipe-uri se realizează cu ajutorul funcțiilor <code>read</code>/<code>write</code>. </div>
</li>
</ul>

<p>
Majoritatea aplicațiilor care folosesc pipe-uri închid în fiecare dintre procese capătul de pipe <strong>neutilizat</strong> în comunicarea unidirecțională. Dacă unul dintre descriptori este închis se aplică regulile:
</p>
<ul>
<li class="level1"><div class="li">o citire dintr-un pipe pentru care descriptorul de <strong>scriere</strong> a fost închis, după ce toate datele au fost citite, va returna <code>0</code>, ceea ce indică sfârșitul fișierului. Descriptorul de scriere poate fi duplicat astfel încât mai multe procese să poată scrie în pipe. De regulă, în cazul pipe-urilor anonime există doar două procese, unul care scrie și altul care citește, pe când în cazul fișierelor pipe cu nume (FIFO) pot exista mai multe procese care scriu date.</div>
</li>
<li class="level1"><div class="li">o scriere într-un pipe pentru care descriptorul de <strong>citire</strong> a fost închis cauzează generarea semnalului <code>SIGPIPE</code>. Dacă semnalul este captat și se revine din rutina de tratare, funcția de sistem <code>write</code> returnează eroare și variabila <code>errno</code> are valoarea <code>EPIPE</code>. </div>
</li>
</ul>

<p>
<p><div class="noteimportant"> Cea mai frecventă <strong>greșeală</strong>, relativ la lucrul cu pipe-urile, provine din neglijarea faptului că nu se trimite <code><abbr title="End of file">EOF</abbr></code> prin pipe (citirea din pipe nu se termină) decât dacă sunt închise <strong>TOATE</strong> capetele de scriere din <strong>TOATE</strong> procesele care au deschis descriptorul de scriere în pipe (în cazul unui <code>fork</code>, nu uitați să închideți capetele pipe-ului în procesul părinte). 
</div></p>
</p>

<p>
Alte funcții utile: <a href="http://linux.die.net/man/3/popen" class="urlextern" title="http://linux.die.net/man/3/popen"  rel="nofollow">popen</a>, <a href="http://linux.die.net/man/3/pclose" class="urlextern" title="http://linux.die.net/man/3/pclose"  rel="nofollow">pclose</a>.
</p>

</div>

<h3 class="sectionedit18" id="pipe-uri_cu_nume_in_linux">Pipe-uri cu nume în Linux</h3>
<div class="level3">

<p>
Elimină necesitatea ca procesele care comunică să fie înrudite. Astfel, fiecare proces își poate deschide pentru citire sau scriere fișierul pipe cu nume (FIFO), un tip de fișier special, care păstrează în spate caracteristicile unui pipe. Comunicația se face într-un sens sau în ambele sensuri. Fișierele de tip FIFO pot fi identificate prin litera <code>p</code> în primul câmp al drepturilor de acces (<code>ls -l</code>).
</p>

<p>
Apelul de bibliotecă pentru crearea pipe-urilor de tip FIFO este <a href="http://linux.die.net/man/3/mkfifo" class="urlextern" title="http://linux.die.net/man/3/mkfifo"  rel="nofollow">mkfifo</a>:
</p>
<pre class="code c"><span class="kw4">int</span> mkfifo<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>pathname<span class="sy0">,</span> mode_t mode<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
După ce pipe-ul FIFO a fost creat, acestuia i se pot aplica toate funcțiile pentru operații obișnuite pentru lucrul cu fișiere: <code>open</code>, <code>close</code>, <code>read</code>, <code>write</code>.
</p>

<p>
Modul de comportare al unui pipe FIFO după deschidere este afectat de flagul <code>O_NONBLOCK</code>:
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Detalii despre flagul O_NONBLOCK
</p>
</div><div class="hiddenOnVisible">
<p>
Detalii despre flagul O_NONBLOCK
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody"><ul>
<li class="level1"><div class="li">dacă <code>O_NONBLOCK</code> nu este specificat (cazul normal), atunci un <code>open</code> pentru citire se va bloca până când un alt proces deschide același FIFO pentru scriere. Analog, dacă deschiderea este pentru scriere, se poate produce blocare până când un alt proces efectuează deschiderea pentru citire.</div>
</li>
<li class="level1"><div class="li">dacă se specifică <code>O_NONBLOCK</code>, atunci deschiderea pentru citire revine imediat, dar o deschidere pentru scriere poate returna eroare cu <code>errno</code> având valoarea <code>ENXIO</code>, dacă nu există un alt proces care a deschis același FIFO pentru citire. </div>
</li>
</ul>
</div></div>
<p>
Atunci când se închide ultimul descriptor de fișier al capătului de scriere pentru un FIFO, se generează un „sfârșit de fișier” – <code><abbr title="End of file">EOF</abbr></code> – pentru procesul care citește din FIFO.
</p>

</div>

<h2 class="sectionedit19" id="depanarea_unui_proces">Depanarea unui proces</h2>
<div class="level2">

<p>
Informații suplimentare legate de depanarea unui proces se găsesc <a href="/courses/so/laboratoare/resurse/gdb#depanarea_unui_proces" class="wikilink1" title="so:laboratoare:resurse:gdb"> aici</a>
</p>

</div>

<h2 class="sectionedit20" id="procese_in_windows">Procese în Windows</h2>
<div class="level2">

</div>

<h3 class="sectionedit21" id="crearea_unui_proces_in_windows">Crearea unui proces în Windows</h3>
<div class="level3">

<p>
În Windows, atât crearea unui nou proces, cât și înlocuirea imaginii lui cu cea dintr-un program executabil se realizează prin apelul funcției <a href="http://msdn.microsoft.com/en-us/library/ms682425.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425.aspx"  rel="nofollow">CreateProcess</a>.
</p>
<table class="columns-plugin" style="width:100%">
<tr><td class="columns-plugin first" style="width:100%;">
<pre class="code c">BOOL CreateProcess<span class="br0">&#40;</span>
     LPCTSTR               lpApplicationName<span class="sy0">,</span>
     LPTSTR                lpCommandLine<span class="sy0">,</span>
     LPSECURITY_ATTRIBUTES lpProcessAttributes<span class="sy0">,</span>
     LPSECURITY_ATTRIBUTES lpThreadAttributes<span class="sy0">,</span>
     BOOL                  bInheritHandles<span class="sy0">,</span>
     DWORD                 dwCreationFlags<span class="sy0">,</span>
     LPVOID                lpEnvironment<span class="sy0">,</span>
     LPCTSTR               lpCurrentDirectory<span class="sy0">,</span>
     LPSTARTUPINFO         lpStartupInfo<span class="sy0">,</span>
     LPPROCESS_INFORMATION lpProcessInformation
<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</td><td class="columns-plugin last">
<pre class="code c">BOOL bRes <span class="sy0">=</span> CreateProcess<span class="br0">&#40;</span>
     NULL<span class="sy0">,</span>          <span class="co1">// No module name</span>
     <span class="st0">&quot;notepad.exe&quot;</span>  <span class="co1">// Command line</span>
     NULL<span class="sy0">,</span>          <span class="co1">// Process handle not inheritable</span>
     NULL<span class="sy0">,</span>          <span class="co1">// Thread handle not inheritable</span>
     FALSE<span class="sy0">,</span>         <span class="co1">// Set handle inheritance to false</span>
     <span class="nu0">0</span><span class="sy0">,</span>             <span class="co1">// No creation flags</span>
     NULL<span class="sy0">,</span>          <span class="co1">// Use parent's environment block</span>
     NULL<span class="sy0">,</span>          <span class="co1">// Use parent's starting directory</span>
     <span class="sy0">&amp;</span>si<span class="sy0">,</span>           <span class="co1">// Pointer to STARTUPINFO structure</span>
     <span class="sy0">&amp;</span>pi            <span class="co1">// Pointer to PROCESS_INFORMATION</span>
<span class="br0">&#41;</span><span class="sy0">;</span>                  <span class="co1">// structure</span></pre>
</td></tr></table>

<p>
<abbr title="Application Programming Interface">API</abbr>-ul Windows mai pune la dispoziție câteva funcții înrudite precum <a href="http://msdn.microsoft.com/en-us/library/ms682429%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682429%28VS.85%29.aspx"  rel="nofollow"> CreateProcessAsUser</a>, <a href="http://msdn.microsoft.com/en-us/library/ms682431%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682431%28VS.85%29.aspx"  rel="nofollow"> CreateProcessWithLogonW</a> ori <a href="http://msdn.microsoft.com/en-us/library/ms682434%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682434%28VS.85%29.aspx"  rel="nofollow"> CreateProcessWithTokenW</a>, care permit crearea unui proces într-un context de securitate diferit de cel al utilizatorului curent. 
</p>

<p>
Pentru a se obține un handle al unui proces, cunoscându-se <code>PID</code>-ul procesului respectiv, se va apela funcția <a href="http://msdn.microsoft.com/en-us/library/ms684320(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms684320(VS.85).aspx"  rel="nofollow"> OpenProcess</a>:
</p>
<pre class="code c">HANDLE OpenProcess<span class="br0">&#40;</span>
        DWORD dwDesiredAccess<span class="sy0">,</span>
        BOOL  bInheritHandle<span class="sy0">,</span>
        DWORD dwProcessId
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
iar pentru a obține un handle al procesului curent se va apela <a href="http://msdn.microsoft.com/en-us/library/ms683179(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683179(VS.85).aspx"  rel="nofollow">GetCurrentProcess</a>:
</p>
<pre class="code c">HANDLE GetCurrentProcess<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Pentru a obține <code>PID</code>-ul procesului curent se va apela <a href="http://msdn.microsoft.com/en-us/library/ms683180(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683180(VS.85).aspx"  rel="nofollow">GetCurrentProcessId</a>:
</p>
<pre class="code c">DWORD GetCurrentProcessId<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Spre deosebire de Linux, în Windows nu se impune o ierarhie a proceselor în sistem. Teoretic există o ierarhie implicită din modul cum sunt create procesele. Un proces deține handle-uri ale proceselor create de el, însă handle-urile pot fi duplicate între procese ceea ce duce la situația în care un proces deține handle-uri ale unor procese care nu sunt create de el, deci ierarhia implicită dispare.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Așteptarea inițializării procesului creat
</p>
</div><div class="hiddenOnVisible">
<p>
Așteptarea inițializării procesului creat
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Deoarece funcția <a href="http://msdn.microsoft.com/en-us/library/ms682425.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425.aspx"  rel="nofollow">CreateProcess</a> se întoarce imediat, fără a aștepta ca procesul nou creat să-și termine inițializările, este nevoie de un mecanism prin care procesul părinte să se sincronizeze cu procesul copil înainte de a încerca să comunice cu acesta. Windows pune la dispoziție funcția de așteptare <a href="http://msdn.microsoft.com/en-us/library/ms687022.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms687022.aspx"  rel="nofollow">WaitForInputIdle</a>.
</p>
<pre class="code c">DWORD WaitForInputIdle<span class="br0">&#40;</span>
        HANDLE hProcess<span class="sy0">,</span>
        DWORD  dwMilliseconds
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Funcția va cauza blocarea firului de execuție apelant până în momentul în care procesul <code>hProcess</code> și-a terminat inițializarea și așteaptă date de intrare. Funcția poate fi folosită oricând pentru a aștepta ca procesul <code>hProcess</code> să treacă în starea în care așteaptă date de intrare, nu doar la momentul creării sale. Funcției i se poate specifica o durată de așteptare prin intermediul parametrului <code>dwMilliseconds</code>.
</p>
</div></div>
</div>

<h3 class="sectionedit22" id="asteptarea_terminarii_unui_proces_in_windows">Așteptarea terminării unui proces în Windows</h3>
<div class="level3">

<p>
Pentru a suspenda execuția procesului curent până când unul sau mai multe alte procese se termină, se va folosi una din funcțiile de așteptare <a href="http://msdn.microsoft.com/en-us/library/ms687032.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms687032.aspx"  rel="nofollow">WaitForSingleObject</a> ori <a href="http://msdn.microsoft.com/en-us/library/ms687025.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms687025.aspx"  rel="nofollow">WaitForMultipleObjects</a>.
</p>
<pre class="code c">DWORD WaitForSingleObject<span class="br0">&#40;</span>HANDLE hHandle<span class="sy0">,</span> DWORD  dwMilliseconds<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Exemplul următor așteaptă nedefinit terminarea procesului reprezentat de <code>hProcess</code>.
</p>
<pre class="code c">DWORD dwRes <span class="sy0">=</span> WaitForSingleObject<span class="br0">&#40;</span>hProcess<span class="sy0">,</span> INFINITE<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>dwRes <span class="sy0">==</span> WAIT_FAILED<span class="br0">&#41;</span>
        <span class="co1">// handle error</span></pre>

<p>
Funcțiile de așteptare sunt folosite în cadrul mai general al mecanismelor de sincronizare între procese. Mai multe detalii pot fi găsite <a href="/courses/so/laboratoare-2013/laborator-05" class="wikilink1" title="so:laboratoare-2013:laborator-05"> aici</a>.
</p>

</div>

<h3 class="sectionedit23" id="aflarea_codului_de_terminare_a_procesului_asteptat_in_windows">Aflarea codului de terminare a procesului așteptat în Windows</h3>
<div class="level3">

<p>
Pentru a determina codul de eroare cu care s-a terminat un anumit proces, se va apela funcția <a href="http://msdn.microsoft.com/en-us/library/ms683189.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683189.aspx"  rel="nofollow">GetExitCodeProcess</a>:
</p>
<pre class="code c">BOOL GetExitCodeProcess<span class="br0">&#40;</span>HANDLE  hProcess<span class="sy0">,</span> LPDWORD lpExitCode<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Dacă procesul <code>hProcess</code> nu s-a terminat încă, funcția va întoarce în <code>lpExitCode</code> codul de terminare <code>STILL_ACTIVE</code>. Dacă procesul s-a terminat, se va întoarce codul său de terminare care poate fi:
</p>
<ul>
<li class="level1"><div class="li">parametrul transmis uneia din funcțiile <a href="http://msdn.microsoft.com/en-us/library/ms682658(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682658(VS.85).aspx"  rel="nofollow"> ExitProcess</a> sau <a href="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx"  rel="nofollow">TerminateProcess</a> (<code>exit</code> din <code>libc</code>)</div>
</li>
<li class="level1"><div class="li">valoarea returnată de funcția <code>main</code> sau <code>WinMain</code> a procesului</div>
</li>
<li class="level1"><div class="li">codul de eroare al unei excepții netratate care a cauzat terminarea procesului</div>
</li>
<li class="level1"><div class="li">dacă procesul se termină cu succes valoarea întoarsă în <code>lpExitCode</code> va fi 0 sau 1 în caz de eroare.</div>
</li>
</ul>

</div>

<h3 class="sectionedit24" id="terminarea_unui_proces_in_windows">Terminarea unui proces în Windows</h3>
<div class="level3">

<p>
Pentru terminarea procesului curent, Windows <abbr title="Application Programming Interface">API</abbr> pune la dispoziție funcția <a href="http://msdn.microsoft.com/en-us/library/ms682658(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682658(VS.85).aspx"  rel="nofollow"> ExitProcess</a>.
</p>
<pre class="code c"><span class="kw4">void</span> ExitProcess<span class="br0">&#40;</span>UINT uExitCode<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Consecinţele funcţiei <code>ExitProcess</code> sunt:
</p>
<ul>
<li class="level1"><div class="li"> Procesul apelant și toate firele sale de execuție se vor termina imediat.</div>
</li>
<li class="level1"><div class="li"> Toate <code>DLL</code>-urile de care era atașat procesul sunt notificate și se apelează metode de distrugere a resurselor alocate de acestea în spațiul de adresă al procesului.</div>
</li>
<li class="level1"><div class="li"> Toți descriptorii de resurse (handle) ai procesului sunt închiși. </div>
</li>
</ul>

<p>
<p><div class="noteimportant"> <code>ExitProcess</code> nu se ocupă de eliberarea resurselor bibliotecii standard C. Pentru a asigura o
finalizare corectă a programului trebuie apelat <code>exit</code>. 
</div></p>
</p>

<p>
Pentru terminarea unui alt proces din sistem se va apela funcția <a href="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx"  rel="nofollow">TerminateProcess</a>.
</p>
<pre class="code c">BOOL TerminateProcess<span class="br0">&#40;</span>HANDLE hProcess<span class="sy0">,</span> UINT uExitCode<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Funcţia <code>TerminateProcess</code> se ocupă de:
</p>
<ul>
<li class="level1"><div class="li"> A iniția terminarea procesului <code>hProcess</code> și a tuturor firelor sale de execuție. Se vor revoca operațiile de intrare/ieșire neterminate după care funcția <a href="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx"  rel="nofollow">TerminateProcess</a> va întoarce imediat.</div>
</li>
<li class="level1"><div class="li"> A închide toți descriptorii de resurse (handle) ai procesului.</div>
</li>
</ul>

<p>
<p><div class="noteclassic"> Funcția <a href="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx"  rel="nofollow">TerminateProcess</a> este <strong>periculoasă</strong> și se recomandă folosirea ei doar în cazuri extreme, deoarece ea nu notifică <code>DLL</code>-urile de care este atașat procesul <code>hProcess</code> asupra detașării acestuia, lăsând astfel alocate eventualele date rezervate de <code>DLL</code> în spațiul de adrese al procesului. 
</div></p>
</p>

<p>
Terminarea unui proces <strong>nu</strong> implică terminarea proceselor create de acesta.
</p>

</div>

<h3 class="sectionedit25" id="exemplu">Exemplu</h3>
<div class="level3">
<dl class="code">
<dt><a href="/courses/_export/code/so/laboratoare/laborator-03?codeblock=34" title="Download Snippet" class="mediafile mf_c">exec.c</a></dt>
<dd><pre class="code c"><span class="co2">#include &lt;windows.h&gt;</span>
<span class="co2">#include &lt;stdio.h&gt;</span>
<span class="co2">#include &lt;stdlib.h&gt;</span>
<span class="co2">#include &lt;string.h&gt;</span>
&nbsp;
<span class="co2">#include &quot;utils.h&quot;</span>
&nbsp;
<span class="kw4">void</span> CloseProcess<span class="br0">&#40;</span>LPPROCESS_INFORMATION lppi<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    CloseHandle<span class="br0">&#40;</span>lppi<span class="sy0">-&gt;</span>hThread<span class="br0">&#41;</span><span class="sy0">;</span>
    CloseHandle<span class="br0">&#40;</span>lppi<span class="sy0">-&gt;</span>hProcess<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    STARTUPINFO si<span class="sy0">;</span>
    PROCESS_INFORMATION pi<span class="sy0">;</span>
    DWORD dwRes<span class="sy0">;</span>
    BOOL bRes<span class="sy0">;</span>
    CHAR cmdLine<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st0">&quot;mspaint&quot;</span><span class="sy0">;</span>
&nbsp;
    ZeroMemory<span class="br0">&#40;</span><span class="sy0">&amp;</span>si<span class="sy0">,</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>si<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    si.<span class="me1">cb</span> <span class="sy0">=</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>si<span class="br0">&#41;</span><span class="sy0">;</span>
    ZeroMemory<span class="br0">&#40;</span><span class="sy0">&amp;</span>pi<span class="sy0">,</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>pi<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="coMULTI">/* Start child process */</span>
    bRes <span class="sy0">=</span>  CreateProcess<span class="br0">&#40;</span> 
                NULL<span class="sy0">,</span>           <span class="coMULTI">/* No module name (use command line) */</span>
		cmdLine<span class="sy0">,</span>        <span class="coMULTI">/* Command line */</span>
		NULL<span class="sy0">,</span>           <span class="coMULTI">/* Process handle not inheritable */</span>
		NULL<span class="sy0">,</span>           <span class="coMULTI">/* Thread handle not inheritable */</span>
		FALSE<span class="sy0">,</span>          <span class="coMULTI">/* Set handle inheritance to FALSE */</span>
		<span class="nu0">0</span><span class="sy0">,</span>              <span class="coMULTI">/* No creation flags */</span>
		NULL<span class="sy0">,</span>           <span class="coMULTI">/* Use parent's environment block */</span>
		NULL<span class="sy0">,</span>           <span class="coMULTI">/* Use parent's starting directory */</span> 
		<span class="sy0">&amp;</span>si<span class="sy0">,</span>            <span class="coMULTI">/* Pointer to STARTUPINFO structure */</span>
		<span class="sy0">&amp;</span>pi             <span class="coMULTI">/* Pointer to PROCESS_INFORMATION structure */</span>
	<span class="br0">&#41;</span><span class="sy0">;</span> 
    DIE<span class="br0">&#40;</span>bRes <span class="sy0">==</span> FALSE<span class="sy0">,</span> <span class="st0">&quot;CreateProcess&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="coMULTI">/* Wait for the child to finish */</span>
    dwRes <span class="sy0">=</span> WaitForSingleObject<span class="br0">&#40;</span>pi.<span class="me1">hProcess</span><span class="sy0">,</span> INFINITE<span class="br0">&#41;</span><span class="sy0">;</span>
    DIE<span class="br0">&#40;</span>dwRes <span class="sy0">==</span> WAIT_FAILED<span class="sy0">,</span> <span class="st0">&quot;WaitForSingleObject&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    bRes <span class="sy0">=</span> GetExitCodeProcess<span class="br0">&#40;</span>pi.<span class="me1">hProcess</span><span class="sy0">,</span> <span class="sy0">&amp;</span>dwRes<span class="br0">&#41;</span><span class="sy0">;</span>
    DIE<span class="br0">&#40;</span>bRes <span class="sy0">==</span> FALSE<span class="sy0">,</span> <span class="st0">&quot;GetExitCode&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    CloseProcess<span class="br0">&#40;</span><span class="sy0">&amp;</span>pi<span class="br0">&#41;</span><span class="sy0">;</span>    
&nbsp;
    <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</dd></dl>

</div>

<h3 class="sectionedit26" id="mostenirea_handle-urilor_la_createprocess">Moștenirea handle-urilor la CreateProcess</h3>
<div class="level3">

<p>
După un apel <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a>, handle-urile din procesul părinte pot fi <strong>moștenite</strong> în procesul copil. 
</p>

<p>
<p><div class="noteimportant"> Pentru ca un handle să poată fi moștenit în procesul creat, trebuie îndeplinite 2 condiții:
</p>
<ul>
<li class="level1"><div class="li">membrul <code>bInheritHandle</code>, al structurii <code>SECURITY_ATTRIBUTES</code>, transmise lui <a href="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx"  rel="nofollow"> CreateFile</a>, trebuie să fie <code>TRUE</code></div>
</li>
<li class="level1"><div class="li">parametrul <code>bInheritHandles</code>, al lui <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a>, trebuie să fie <code>TRUE</code>. </div>
</li>
<li class="level1"><div class="li">atunci când se doreşte moştenierea handler-elor în procesul copil, trebuie să ne asigurăm că acestea sunt valide deorece în procesul copil nu se fac validări suplimentare. Transmiterea unor handlere invalide poate duce la un comportament nedefinit în procesul copil.</div>
</li>
</ul>

<p>

</div></p>
</p>

<p>
Handle-urile moștenite sunt valide doar în contextul procesului copil.
</p>

<p>
Cei 3 descriptori speciali de fișier pot fi obținuți apelând funcția <a href="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx"  rel="nofollow">GetStdHandle</a>:
</p>
<pre class="code c">HANDLE GetStdHandle<span class="br0">&#40;</span>DWORD nStdHandle<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
cu unul din parametrii:
</p>
<ul>
<li class="level1"><div class="li"><code>STD_INPUT_HANDLE</code></div>
</li>
<li class="level1"><div class="li"><code>STD_OUTPUT_HANDLE</code></div>
</li>
<li class="level1"><div class="li"><code>STD_ERROR_HANDLE</code> </div>
</li>
</ul>

<p>
Pentru <strong>redirectarea</strong> handle-urilor standard în procesul copil puteți folosi membrii <code>hStdInput</code>, <code>hStdOutput</code>, <code>hStdError</code> ai structurii <a href="http://msdn.microsoft.com/en-us/library/ms686331(v=VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686331(v=VS.85).aspx"  rel="nofollow"> STARTUPINFO</a>, transmise lui <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a>. În acest caz, membrul <code>dwFlags</code> al aceleiași structuri trebuie setat la <code>STARTF_USESTDHANDLES</code>. Dacă se dorește ca anumite handle-uri să rămână implicite, li se poate atribui handle-ul întors de <a href="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx"  rel="nofollow"> GetStdHandle</a>.
</p>
<pre class="code C">STARTUPINFO si<span class="sy0">;</span>
...
<span class="coMULTI">/* initialize process startup info structure */</span>
ZeroMemory<span class="br0">&#40;</span><span class="sy0">&amp;</span>si<span class="sy0">,</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>si<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
si.<span class="me1">cb</span> <span class="sy0">=</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>si<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="coMULTI">/* setup flags to allow handle inheritence (redirection) */</span>
si.<span class="me1">dwFlags</span> <span class="sy0">|=</span> STARTF_USESTDHANDLES<span class="sy0">;</span></pre>

<p>
<p><div class="noteimportant"> Pentru a realiza redirectarea in mod corespunzător, câmpurile <code>hStdInput</code>, <code>hStdOutput</code>, <code>hStdError</code> din structura <code>STARTUPINFO</code> trebuie inițializate. 
</div></p>
</p>

<p>
Alte proprietăți ale procesului părinte care pot fi moștenite sunt variabilele de mediu și directorul curent. <strong>Nu</strong> vor fi moștenite handle-uri ale unor zone de memorie alocate de procesul părinte și nici pseudo-descriptori precum cei întorși de funcția <a href="http://msdn.microsoft.com/en-us/library/ms683179%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683179%28VS.85%29.aspx"  rel="nofollow"> GetCurrentProcess</a>.
</p>

<p>
Handle-ul din procesul părinte și cel moștenit în procesul copil vor referi același obiect, exact ca în cazul duplicării. De asemenea, handle-ul moștenit în procesul copil are aceeași valoare și aceleași drepturi de acces ca și handle-ul din procesul părinte. Pentru a folosi handle-ul moștenit, procesul copil va trebui să-i cunoască valoarea și ce obiect referă. Aceste informații trebuie să fie pasate de părinte printr-un mecanism extern (IPC etc).
</p>

</div>

<h2 class="sectionedit27" id="variabile_de_mediu_in_windows">Variabile de mediu în Windows</h2>
<div class="level2">

<p>
Pentru a afla valoarea unei variabile de mediu se va apela funcția <a href="http://msdn.microsoft.com/en-us/library/ms683188(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683188(VS.85).aspx"  rel="nofollow">GetEnvironmentVariable</a>:
</p>
<pre class="code c">DWORD GetEnvironmentVariable<span class="br0">&#40;</span>
        LPCTSTR lpName<span class="sy0">,</span>
        LPTSTR  lpBuffer<span class="sy0">,</span>
        DWORD   nSize
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
care va umple <code>lpBuffer</code>, de dimensiune <code>nSize</code>, cu valoarea variabilei <code>lpName</code>.
</p>

<p>
Pentru a seta o variabilă de mediu se va apela <a href="http://msdn.microsoft.com/en-us/library/ms686206(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686206(VS.85).aspx"  rel="nofollow">SetEnvironmentVariable</a>:
</p>
<pre class="code c">BOOL SetEnvironmentVariable<span class="br0">&#40;</span>
        LPCTSTR lpName<span class="sy0">,</span>
        LPCTSTR lpValue
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
care va seta variabila <code>lpName</code> la valoarea specificată de <code>lpValue</code>. Funcția se va folosi și pentru ștergerea unei variabile de mediu prin transmiterea unui parametru <code>lpValue = NULL</code>. <a href="http://msdn.microsoft.com/en-us/library/ms686206(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686206(VS.85).aspx"  rel="nofollow">SetEnvironmentVariable</a> are efect doar asupra variabilelor de mediu ale utilizatorului și nu poate modifica variabile de mediu globale.
</p>

<p>
În Windows există un set de variabile de mediu globale, valabile pentru toți utilizatorii. În plus, fiecare utilizator în parte are asociat un set propriu de variabile de mediu. Împreună, cele două seturi formează <code>Environment Block</code>-ul utilizatorului respectiv. Acest <code>Environment Block</code> este similar cu variabila <code>environ</code>, din Linux.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Detalii despre <code>Environment Block</code>
</p>
</div><div class="hiddenOnVisible">
<p>
Detalii despre <code>Environment Block</code>
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Un utilizator are acces la propriul <code>Environment Block</code> prin apelul funcției <a href="http://msdn.microsoft.com/en-us/library/ms683187(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683187(VS.85).aspx"  rel="nofollow">GetEnvironmentStrings</a>:
</p>
<pre class="code c">LPTCH GetEnvironmentStrings<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
care îi va întoarce un pointer spre acesta, pe care îl poate elibera cu <a href="http://msdn.microsoft.com/en-us/library/ms683151(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683151(VS.85).aspx"  rel="nofollow">FreeEnvironmentStrings</a>:
</p>
<pre class="code c">BOOL FreeEnvironmentStrings<span class="br0">&#40;</span>
        LPTSTR lpszEnvironmentBlock
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Un proces copil va moșteni <code>Environment Block</code>-ul părintelui dacă acesta apelează <code>CreateProcess</code>, cu parametrul <code>lpEnvironment = NULL</code>.
</p>

<p>
Se poate obține <code>Environment Block</code>-ul unui alt utilizator prin intermediul funcției <a href="http://msdn.microsoft.com/en-us/library/bb762270(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/bb762270(VS.85).aspx"  rel="nofollow">CreateEnvironmentBlock</a>:
</p>
<pre class="code c">BOOL CreateEnvironmentBlock<span class="br0">&#40;</span>
        LPVOID<span class="sy0">*</span> lpEnvironment<span class="sy0">,</span>
        HANDLE  hToken<span class="sy0">,</span>
        BOOL    bInherit
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Trebuie să pasăm <code>hToken</code>, token-ul asociat utilizatorului al cărui bloc vrem să-l aflăm, pe care putem să-l obținem prin apelarea funcției <a href="http://msdn.microsoft.com/en-us/library/aa378184.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa378184.aspx"  rel="nofollow">LogonUser</a>:
</p>
<pre class="code c">BOOL LogonUser<span class="br0">&#40;</span>
        LPTSTR  lpszUsername<span class="sy0">,</span>
        LPTSTR  lpszDomain<span class="sy0">,</span>
        LPTSTR  lpszPassword<span class="sy0">,</span>
        DWORD   dwLogonType<span class="sy0">,</span>
        DWORD   dwLogonProvider<span class="sy0">,</span>
        PHANDLE phToken
<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Și, bineînțeles, trebuie cunoscută parola utilizatorului respectiv.
</p>

<p>
<code>Environment Block</code>-ul, obținut prin <code>CreateEnvironmentBlock</code>, poate fi transmis ca parametru funcției <a href="http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx"  rel="nofollow">CreateProcessAsUser</a>, și se va distruge prin apelul funcției <a href="http://msdn.microsoft.com/en-us/library/bb762274(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/bb762274(VS.85).aspx"  rel="nofollow">DestroyEnvironmentBlock</a>:
</p>
<pre class="code c">BOOL DestroyEnvironmentBlock<span class="br0">&#40;</span>
        LPVOID lpEnvironment
<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div></div>
</div>

<h2 class="sectionedit28" id="pipe-uri_in_windows">Pipe-uri în Windows</h2>
<div class="level2">

</div>

<h3 class="sectionedit29" id="pipe-uri_anonime_in_windows">Pipe-uri anonime în Windows</h3>
<div class="level3">

<p>
Ca și pe Linux, pipe-urile anonime de pe Windows sunt unidirecționale. Fiecare pipe are două capete reprezentate de câte un handle: un handle de citire și un handle de scriere. Funcția de creare a unui pipe este <a href="http://msdn.microsoft.com/en-us/library/aa365152(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365152(VS.85).aspx"  rel="nofollow">CreatePipe</a>:
</p>
<table class="columns-plugin" style="width:100%">
<tr><td class="columns-plugin first" style="width:40%;">
<pre class="code c">BOOL CreatePipe<span class="br0">&#40;</span>
     PHANDLE               hReadPipe<span class="sy0">,</span>
     PHANDLE               hWritePipe<span class="sy0">,</span>
     LPSECURITY_ATTRIBUTES lpPipeAttributes<span class="sy0">,</span>
     DWORD                 nSize
<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</td><td class="columns-plugin last">
<pre class="code c">CreatePipe<span class="br0">&#40;</span>
    <span class="sy0">&amp;</span>hReadPipe<span class="sy0">,</span> 
    <span class="sy0">&amp;</span>hWritePipe<span class="sy0">,</span>
    <span class="sy0">&amp;</span>sa<span class="sy0">,</span>        <span class="co1">//pentru moștenire sa.bInheritHandle=TRUE</span>
    <span class="nu0">0</span>           <span class="co1">//dimensiunea default pentru pipe</span>
<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</td></tr></table>

<p>
<p><div class="noteimportant"> Pentru a <strong>moșteni</strong> un pipe anonim, este nevoie ca parametrul <code>bInheritHandle</code> din structura <a href="http://msdn.microsoft.com/en-us/library/aa379560%28v=VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa379560%28v=VS.85%29.aspx"  rel="nofollow">LPSECURITY_ATTRIBUTES</a> să fie setat pe TRUE. 
</div></p>
</p>

<p>
<code>CreatePipe</code> creează atât pipe-ul, cât și handler-urile folosite pentru scriere/citire din/în pipe cu ajutorul funcțiilor <a href="http://msdn.microsoft.com/en-us/library/aa914377.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa914377.aspx"  rel="nofollow">ReadFile</a> și <a href="http://msdn.microsoft.com/en-us/library/aa910675.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa910675.aspx"  rel="nofollow">WriteFile</a>.
</p>

<p>
<a href="http://msdn.microsoft.com/en-us/library/aa914377.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa914377.aspx"  rel="nofollow">ReadFile</a> se termină în unul din cazurile:
</p>
<ul>
<li class="level1"><div class="li"> o operație de scriere a luat sfârșit la capătul de scriere în pipe</div>
</li>
<li class="level1"><div class="li"> numărul de octeți cerut a fost citit</div>
</li>
<li class="level1"><div class="li"> a apărut o eroare.</div>
</li>
</ul>

<p>
<a href="http://msdn.microsoft.com/en-us/library/aa910675.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa910675.aspx"  rel="nofollow">WriteFile</a> se termină atunci când toți octeții au fost scriși. Dacă bufferul pipe-ului este plin înainte ca toți octeții să fie scriși, <a href="http://msdn.microsoft.com/en-us/library/aa910675.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa910675.aspx"  rel="nofollow">WriteFile</a> rămâne blocat până când alt proces sau thread folosește <a href="http://msdn.microsoft.com/en-us/library/aa914377.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa914377.aspx"  rel="nofollow">ReadFile</a> pentru a face loc în buffer.
</p>

<p>
Un pipe anonim este considerat închis doar când ambele capete ale sale, cel de citire și cel de scriere, sunt închise prin intermediul funcției <a href="https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-closehandle" class="urlextern" title="https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-closehandle"  rel="nofollow">CloseHandle</a>. 
</p>

<p>
Pipe-urile anonime sunt implementate folosind un pipe cu nume unic. De aceea se poate pasa un handle al unui pipe anonim unei funcții care cere un handle al unui pipe cu nume.
</p>

</div>

<h3 class="sectionedit30" id="pipe-uri_cu_nume_in_windows">Pipe-uri cu nume în Windows</h3>
<div class="level3">

<p>
În Windows, un pipe cu nume este un pipe <em>unidirecțional</em> (inbound ori outbound) sau <em>bidirecțional</em> ce realizează comunicația între un server pipe și unul sau mai mulți clienți pipe. Se numește <em>server pipe</em> procesul care creează un pipe cu nume și <em>client pipe</em> procesul care se conectează la pipe. 
Pentru a face posibilă comunicarea între server și mai mulți clienți prin același pipe, se folosesc instanțe ale pipe-ului. O instanță a unui pipe folosește același nume, dar are propriile handle-uri și buffere. 
</p>

<p>
Pipe-urile cu nume au următoarele caracteristici care le diferențiază de cele anonime:
</p>
<ul>
<li class="level1"><div class="li">sunt orientate pe mesaje - se pot transmite mesaje de lungime variabilă (nu numai byte stream); </div>
</li>
<li class="level1"><div class="li">sunt bidirecționale - două procese pot schimba mesaje pe același pipe;</div>
</li>
<li class="level1"><div class="li">pot exista mai multe instanțe ale aceluiași pipe</div>
</li>
<li class="level1"><div class="li">poate fi accesat din rețea - comunicația între două procese aflate pe mașini diferite este aceeași cu cea între procese aflate pe aceeași mașină.</div>
</li>
</ul>

</div>

<h4 id="mod_de_lucru_-_server_pipe">Mod de lucru - Server Pipe</h4>
<div class="level4">

<p>
Serverul creează un pipe cu funcția <a href="http://msdn.microsoft.com/en-us/library/aa365150%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365150%28VS.85%29.aspx"  rel="nofollow">CreateNamedPipe</a>. 
</p>
<table class="columns-plugin" style="width:100%">
<tr><td class="columns-plugin first">
<pre class="code c">HANDLE CreateNamedPipe<span class="br0">&#40;</span>
   LPCTSTR               lpName<span class="sy0">,</span>
   DWORD                 dwOpenMode<span class="sy0">,</span>
   DWORD                 dwPipeMode<span class="sy0">,</span>
   DWORD                 nMaxInstances<span class="sy0">,</span>
   DWORD                 nOutBufferSize<span class="sy0">,</span>
   DWORD                 nInBufferSize<span class="sy0">,</span>
   DWORD                 nDefaultTimeOut<span class="sy0">,</span>
   LPSECURITY_ATTRIBUTES lpSecurityAttributes
<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</td><td class="columns-plugin last">
<pre class="code c">HANDLE hNamedPipe <span class="sy0">=</span> CreateNamedPipe<span class="br0">&#40;</span>
   <span class="st0">&quot;<span class="es1">\\</span><span class="es1">\\</span>.<span class="es1">\\</span>pipe<span class="es1">\\</span>mypipe&quot;</span><span class="sy0">,</span>     <span class="co1">// name</span>
   PIPE_ACCESS_DUPLEX<span class="sy0">,</span>        <span class="co1">// read/write access</span>
   PIPE_TYPE_BYTE <span class="sy0">|</span> PIPE_WAIT<span class="sy0">,</span><span class="co1">// byte stream</span>
   PIPE_UNLIMITED_INSTANCES<span class="sy0">,</span>  <span class="co1">// max. instances  </span>
   BUFSIZE<span class="sy0">,</span>                   <span class="co1">// output buffer size </span>
   BUFSIZE<span class="sy0">,</span>                   <span class="co1">// input buffer size </span>
   <span class="nu0">0</span><span class="sy0">,</span>                         <span class="co1">// default time out</span>
   NULL                       <span class="co1">// default security </span>
<span class="br0">&#41;</span><span class="sy0">;</span>                            <span class="co1">// attribute </span></pre>
</td></tr></table>

<p>
Funcția returnează un handle către capătul serverului la pipe. Acest handle poate fi transmis funcției <a href="http://msdn.microsoft.com/en-us/library/aa365146(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365146(VS.85).aspx"  rel="nofollow">ConnectNamedPipe</a> pentru a aștepta conectarea unui proces client la o instanță a unui pipe.
</p>
<pre class="code c">BOOL ConnectNamedPipe<span class="br0">&#40;</span>HANDLE hNamedPipe<span class="sy0">,</span> LPOVERLAPPED lpOverlapped<span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h4 id="mod_de_lucru_-_client_pipe">Mod de lucru - Client Pipe</h4>
<div class="level4">

<p>
Un client se conectează transmițând numele pipe-ului la una din funcțiile <a href="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx"  rel="nofollow"> CreateFile</a> sau <a href="http://msdn.microsoft.com/en-us/library/aa365144(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365144(VS.85).aspx"  rel="nofollow"> CallNamedPipe</a> - ultima funcţie este mai utilă pentru transmiterea de mesaje.
</p>

<p>
Un exemplu funcțional folosind pipe-uri cu nume se află <a href="http://msdn.microsoft.com/en-us/library/aa365588%28v=VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365588%28v=VS.85%29.aspx"  rel="nofollow">aici</a>
</p>

<p>
Mai multe detalii despre moștenirea pipe-urilor se pot găsi <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa365782(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/windows/desktop/aa365782(v=vs.85).aspx"  rel="nofollow">aici</a>.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Detalii extra despre pipe-urile cu nume
</p>
</div><div class="hiddenOnVisible">
<p>
Detalii extra despre pipe-urile cu nume
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<strong> Moduri de comunicare </strong>
</p>

<p>
Comunicația prin pipe-urile cu nume poate fi de tip:
</p>
<ul>
<li class="level1"><div class="li"><strong>mesaj</strong></div>
<ul>
<li class="level2"><div class="li"> se scriu/citesc date sub formă de mesaje;</div>
</li>
<li class="level2"><div class="li"> este necesară cunoașterea lungimii mesajului;</div>
</li>
<li class="level2"><div class="li"> se scriu/citesc doar <em>mesaje complete</em>;</div>
</li>
<li class="level2"><div class="li"> creat cu <code>PIPE_TYPE_MESSAGE | PIPE_READMODE_MESSAGE</code>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"><strong>flux de octeți</strong></div>
<ul>
<li class="level2"><div class="li"> nu există nicio garanție asupra numărului de octeți care sunt citiți/scriși în orice moment;</div>
</li>
<li class="level2"><div class="li"> se pot transmite date fără să se țină seama de conținut, pe când, prin pipe-urile de tip mesaj, comunicația are loc în unități discrete (mesaje);</div>
</li>
<li class="level2"><div class="li"> creat cu <code>PIPE_TYPE_BYTE | PIPE_READMODE_BYTE</code> (implicit).</div>
</li>
</ul>
</li>
</ul>

<p>
<strong> Numire </strong>
</p>

<p>
Crearea unui pipe cu nume se poate face numai pe mașina locală (reprezentată prin primul .) cu un string de forma:
</p>
<pre class="code">\\.\pipe\[path]pipename</pre>

<p>
Accesarea unui pipe cu nume se poate face folosind ca parametru un string de forma:
</p>
<pre class="code">\\servername\pipe\[path]pipename</pre>

<p>
<strong> Funcții utile </strong>
</p>

<p>
<a href="http://msdn.microsoft.com/en-us/library/aa365443%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365443%28VS.85%29.aspx"  rel="nofollow">GetNamedPipeHandleState</a> - întoarce informații despre anumite atribute cum ar fi: tipul de comunicare (mesaj sau byte-stream), numărul de instanțe, dacă a fost deschisă în mod blocant sau neblocant.
</p>

<p>
<a href="http://msdn.microsoft.com/en-us/library/aa365787%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365787%28VS.85%29.aspx"  rel="nofollow">SetNamedPipeHandleState</a> - permite modificarea atributelor unui pipe
</p>
</div></div>
</div>

<h2 class="sectionedit31" id="sumar">Sumar</h2>
<div class="level2">
<div class="table sectionedit32"><table class="inline">
	<tr class="row0">
		<th class="col0 centeralign">  <strong>Operație</strong>  </th><th class="col1 centeralign">  <strong>Linux</strong>  </th><th class="col2 centeralign">  <strong>Windows</strong>  </th>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Crearea unui proces  </td><td class="col1 centeralign">  <a href="#crearea_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> fork()  </a>  </td><td class="col2 centeralign">  <a href="#crearea_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> CreateProcess() </a>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  Așteptarea terminării unui proces  </td><td class="col1 centeralign">  <a href="#asteptarea_terminarii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> wait()</a>, <a href="#asteptarea_terminarii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> waitpid()</a>  </td><td class="col2 centeralign">  <a href="#asteptarea_terminarii_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> WaitForSingleObject()</a>  </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  Înlocuirea imaginii unui process  </td><td class="col1 centeralign">  <a href="#inlocuirea_imaginii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> exec() </a>  </td><td class="col2 centeralign">  -  </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  Terminarea unui process  </td><td class="col1 centeralign">  <a href="#terminarea_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> exit()</a>  </td><td class="col2 centeralign">  <a href="#terminarea_unui_proces_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> ExitProcess() </a>  </td>
	</tr>
	<tr class="row5">
		<td class="col0 centeralign">  Moștenirea descriptorilor de fișier  </td><td class="col1 centeralign">  <a href="#mostenirea_descriptorilor_de_fisier_dupa_operatii_forkexec" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> dup() + exec() </a>   </td><td class="col2 centeralign">  <a href="#mostenirea_handle-urilor_la_createprocess" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> CreateProcess() </a>, care are câmpul <code>bInheritHandle</code> al structurii <code>SECURITY_ATTRIBUTES</code> setat pe <code>TRUE</code>  </td>
	</tr>
	<tr class="row6">
		<td class="col0 centeralign">  Variabile de mediu  </td><td class="col1 centeralign">  <a href="#variabile_de_mediu_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> getenv()</a>, <a href="#variabile_de_mediu_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> setenv()</a>  </td><td class="col2 centeralign">   <a href="#variabile_de_mediu_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">GetEnvironmentVariable() </a>, <a href="#variabile_de_mediu_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> SetEnvironmentVariable() </a>  </td>
	</tr>
	<tr class="row7">
		<td class="col0 centeralign">  Pipe anonim  </td><td class="col1 centeralign">  <a href="#pipe-uri_anonime_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> pipe()</a>  </td><td class="col2 centeralign">  <a href="#pipe-uri_anonime_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> CreatePipe() </a>  </td>
	</tr>
	<tr class="row8">
		<td class="col0 centeralign">  Pipe cu nume  </td><td class="col1 centeralign">  <a href="#pipe-uri_cu_nume_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> mkfifo()</a>  </td><td class="col2 centeralign">  <a href="#pipe-uri_cu_nume_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> CreateNamedPipe() </a>  </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit33" id="exercitii">Exerciții</h2>
<div class="level2">

<p>
<p><div class="noteimportant">
În cadrul laboratoarelor vom folosi repository-ul de git al materiei SO - <a href="https://github.com/systems-cs-pub-ro/so" class="urlextern" title="https://github.com/systems-cs-pub-ro/so"  rel="nofollow">https://github.com/systems-cs-pub-ro/so</a>. Va trebui sa clonați repository-ul pe masinile virtuale folosind comanda: <code>git clone <a href="https://github.com/systems-cs-pub-ro/so" class="urlextern" title="https://github.com/systems-cs-pub-ro/so"  rel="nofollow">https://github.com/systems-cs-pub-ro/so</a></code>. Dacă doriți să descărcați repositoryul în altă locație, folosiți comanda <code>git clone <a href="https://github.com/systems-cs-pub-ro/so" class="urlextern" title="https://github.com/systems-cs-pub-ro/so"  rel="nofollow">https://github.com/systems-cs-pub-ro/so</a> ${target}</code>.
</p>

<p>
Pentru a actualiza repository-ul, folosiți comanda <code>git pull origin master</code> din interiorul directorului în care se află repository-ul. Recomandarea este să îl actualizați cât mai frecvent, înainte să începeți lucrul, pentru a vă asigura că aveți versiunea cea mai recentă.În cazul în care gitul detectează conflicte la nivelul vreunui fişier, folosiți următoarele comenzi pentru a vă păstra modificările:
</p>
<pre class="code">git stash
git pull origin master
git stash pop</pre>

<p>
Pentru mai multe informații despre folosirea utilitarului git, urmați ghidul de la <a href="https://gitimmersion.com" class="urlextern" title="https://gitimmersion.com"  rel="nofollow">https://gitimmersion.com</a>.

</div></p>
</p>

<p>
<p><div class="notetip">Pentru a vă ajuta la implementarea exercițiilor din laborator, în directorul <code>utils</code> din arhivă există un fișier <code>utils.h</code> cu funcții utile.
</div></p>
</p>

</div>

<h3 class="sectionedit34" id="exercitiul_0_-_stagii_pe_bune">Exercițiul 0 - Stagii pe bune</h3>
<div class="level3">

<p>
<a href="https://stagiipebune.ro/students/jobs/" class="urlextern" title="https://stagiipebune.ro/students/jobs/"  rel="nofollow">Stagii pe bune</a> este o platformă de internshipuri care vrea să ușureze și să uniformizeze procesul prin care puteți aplica la companii din România (București, Iași, Cluj și Timișoara). Facultatea de Automatică și Calculatoare are un parteneriat cu Stagii pe bune și vă încurajăm să le folosiți platforma pentru a aplica la internshipuri! 
</p>

<p>
Stagii pe bune organizează și evenimente de prezentare a celor mai mari companii din România. Pentru a fi la curent cu acestea, urmăriți și anunțurile postate de Stagii pe bune pe <a href="https://www.facebook.com/stagiipebune" class="urlextern" title="https://www.facebook.com/stagiipebune"  rel="nofollow">Facebook</a>.
</p>

</div>

<h2 class="sectionedit35" id="linux1">Linux</h2>
<div class="level2">

</div>

<h3 class="sectionedit36" id="exercitiul_1_-_system">Exercițiul 1 - system</h3>
<div class="level3">

<p>
Intrați în directorul <code>1-system</code>. 
Programul <code>my_system.c</code> execută o comandă transmisă ca parametru, folosind funcția de bibliotecă <a href="http://linux.die.net/man/3/system" class="urlextern" title="http://linux.die.net/man/3/system"  rel="nofollow">system</a>. Modul de funcționare al <a href="http://linux.die.net/man/3/system" class="urlextern" title="http://linux.die.net/man/3/system"  rel="nofollow">system</a> este următorul:
</p>
<ul>
<li class="level1"><div class="li"> se creează un nou proces cu <a href="http://linux.die.net/man/2/fork" class="urlextern" title="http://linux.die.net/man/2/fork"  rel="nofollow">fork</a></div>
</li>
<li class="level1"><div class="li"> procesul copil execută, folosind <a href="http://linux.die.net/man/2/execve" class="urlextern" title="http://linux.die.net/man/2/execve"  rel="nofollow"> execve</a>, programul <strong><code>sh</code></strong> cu argumentele -c “comanda”, timp în care procesul părinte așteaptă terminarea procesului copil.</div>
</li>
</ul>

<p>
Compilați (folosind <code>make</code>) și rulați programul dând ca parametru o comandă.
</p>
<ul>
<li class="level1"><div class="li"> Exemplu: <pre class="code bash"> .<span class="sy0">/</span>my_system <span class="kw3">pwd</span> </pre>
</div>
</li>
</ul>

<p>
Cum procedați pentru a trimite mai mulți parametri unei comenzi? (ex: <code>ls -la</code>)
</p>

<p>
Pentru a vedea câte apeluri de sistem <a href="http://linux.die.net/man/2/execve" class="urlextern" title="http://linux.die.net/man/2/execve"  rel="nofollow"> execve</a> se realizează, rulați:
</p>
<pre class="code bash"> <span class="kw2">strace</span> <span class="re5">-e</span> execve,clone <span class="re5">-ff</span> <span class="re5">-o</span> output .<span class="sy0">/</span>my_system <span class="kw2">ls</span> </pre>
<ul>
<li class="level1"><div class="li"> <strong>atenție!</strong> nu este spațiu după virgulă în argumentul <code>execve,clone</code></div>
</li>
<li class="level1"><div class="li"> argumentul <code>-ff</code> însoțit de <code>-o output</code> generează câte un fișier de output pentru fiecare proces.</div>
<ul>
<li class="level3"><div class="li"> cițiți pagina de manual <a href="http://linux.die.net/man/1/strace" class="urlextern" title="http://linux.die.net/man/1/strace"  rel="nofollow">strace</a></div>
</li>
</ul>
</li>
</ul>

<p>
Revedeți secțiunea <a href="#inlocuirea_imaginii_unui_proces_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Înlocuirea imaginii unui proces în Linux</a> și pagina de manual pentru <a href="http://linux.die.net/man/2/execve" class="urlextern" title="http://linux.die.net/man/2/execve"  rel="nofollow"> execve </a>.
</p>

</div>

<h3 class="sectionedit37" id="exercitiul_2_-_orphan">Exercițiul 2 - orphan</h3>
<div class="level3">

<p>
Intrați în directorul <code>2-orphan</code> și inspectați sursa <code>orphan.c</code>. 
</p>

<p>
Compilați programul (<code>make</code>) și apoi rulați-l folosind comanda:
</p>
<pre class="code bash">​ .<span class="sy0">/</span>​orphan </pre>

<p>
Deschideți alt terminal și rulați comanda: 
</p>
<pre class="code bash"> <span class="kw2">watch</span> <span class="re5">-d</span> <span class="st_h">'(ps -al | grep -e orphan -e PID)'</span> </pre>

<p>
Observați că pentru procesul indicat de executabilul <code>​orphan</code>​ (coloana <code>​CMD</code>​),​ pid-ul procesului părinte (coloana <code>​PPID</code>​) devine 1, întrucât procesul este adoptat de <code>​init</code>​ după terminarea procesului său părinte.
</p>

</div>

<h3 class="sectionedit38" id="exercitiul_3_-_tiny-shell">Exercițiul 3 - Tiny-Shell</h3>
<div class="level3">

<p>
Intrați în directorul <code>3-tiny</code>.
</p>

<p>
Următoarele subpuncte au ca scop implementarea unui shell minimal, care oferă suport pentru execuția unei <em>singure</em> comenzi externe cu argumente multiple și redirectări. Shell-ul trebuie să ofere suport pentru folosirea și setarea variabilelor de mediu.
</p>

<p>
<em>Observație:</em> Pentru a ieși din tiny shell folosiți <code>exit</code> sau <code>CTRL+D</code>.
</p>

</div>

<h4 id="a_executia_unei_comenzi_simple">3a. Execuția unei comenzi simple</h4>
<div class="level4">

<p>
Creați un nou proces care să execute o comandă simplă.
</p>

<p>
Funcția <code>simple_cmd</code> primește ca argument un vector de șiruri ce conține comanda și parametrii acesteia.
</p>

<p>
Citiți exemplul <a href="#exemplu_my_system" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> my_system</a> și urmăriți în cod comentariile cu <code>TODO 1</code>.
Pentru testare puteți folosi comenzile:  
</p>
<pre class="code bash"> .<span class="sy0">/</span>tiny
<span class="sy0">&gt;</span> <span class="kw3">pwd</span>
<span class="sy0">&gt;</span> <span class="kw2">ls</span> <span class="re5">-al</span>
<span class="sy0">&gt;</span> <span class="kw3">exit</span> </pre>

</div>

<h4 id="b_adaugare_suport_pentru_setarea_si_expandarea_variabilelor_de_mediu">3b. Adăugare suport pentru setarea și expandarea variabilelor de mediu</h4>
<div class="level4">

<p>
Trebuie să completați funcțiile <code>set_var</code> și <code>expand</code>; acestea sunt apelate deja atunci când se face parsarea liniei de comandă. Verificarea erorilor trebuie făcută în aceaste funcții.
</p>
<ul>
<li class="level1"><div class="li"> Urmăriți în cod comentariile cu <code>TODO 2</code>.</div>
</li>
<li class="level8"><div class="li"> Citiți secțiunea <a href="#variabile_de_mediu_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1"> Variabile de mediu in Linux</a>.</div>
</li>
<li class="level8"><div class="li"> Pentru testare puteți folosi comenzile: <pre class="code bash"> .<span class="sy0">/</span>tiny
<span class="sy0">&gt;</span> <span class="kw3">echo</span> <span class="re1">$HOME</span>
<span class="sy0">&gt;</span> <span class="re2">name</span>=Makefile 
<span class="sy0">&gt;</span> <span class="kw3">echo</span> <span class="re1">$name</span>  </pre>
</div>
</li>
</ul>

</div>

<h4 id="c_redirectarea_iesirii_standard">3c. Redirectarea ieșirii standard</h4>
<div class="level4">

<p>
Completați funcția <code>do_redirect</code> astfel încât tiny-shell trebuie să suporte redirectarea output-ului unei comenzi (stdout) într-un fișier.
</p>

<p>
Dacă fișierul indicat de <code>filename</code> nu există, va fi creat. Dacă există, trebuie trunchiat.
</p>

<p>
Citiți secțiunea <a href="#copierea_descriptorilor_de_fisier" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Copierea descriptorilor de fișier</a> și urmăriți în cod comentariile cu <code>TODO 3</code>.
Pentru testare puteți folosi comenzile: 
</p>
<pre class="code bash"> .<span class="sy0">/</span>tiny 
<span class="sy0">&gt;</span> <span class="kw2">ls</span> <span class="re5">-al</span> <span class="sy0">&gt;</span> out
<span class="sy0">&gt;</span> <span class="kw2">cat</span> out
<span class="sy0">&gt;</span> <span class="kw3">pwd</span> <span class="sy0">&gt;</span> out
<span class="sy0">&gt;</span> <span class="kw2">cat</span> out</pre>

</div>

<h2 class="sectionedit39" id="windows1">Windows</h2>
<div class="level2">

<p>
<p><div class="noteimportant"> Pentru exerciţiul <strong>Tiny-Shell on Windows</strong> compilarea se va realiza din Visual Studio sau din command-prompt-ul de Visual Studio, iar rularea executabilului <code>.\2-tiny.exe</code> se va realiza din <strong>Cygwin</strong>.
</p>
<ul>
<li class="level1"><div class="li"> Pentru a ajunge din Cygwin pe Desktop (atenție la folosirea apostrofurilor):<pre class="code bash"><span class="co4">$ </span><span class="kw3">cd</span> <span class="st_h">'C:\Users\Student\Desktop'</span></pre>
</div>
</li>
</ul>

<p>

</div></p>
</p>

</div>

<h3 class="sectionedit40" id="exercitiul_1_-_bomb">Exercițiul 1 - Bomb</h3>
<div class="level3">

<p>
Deschideți proiectul (fișierul <code>.sln</code>) și compilați primul subproiect: <code>1-bomb</code>.
</p>

<p>
Inspectați sursa <code>1-bomb.c</code>. Ce credeți că face? <a href="https://en.wikipedia.org/wiki/Fork_bomb" class="urlextern" title="https://en.wikipedia.org/wiki/Fork_bomb"  rel="nofollow"> Fork Bomb</a>
</p>

<p>
<p><div class="notewarning"> NU executați 1-bomb.exe 
</div></p>
</p>

</div>

<h3 class="sectionedit41" id="exercitiul_2_-_tiny-shell_on_windows">Exercițiul 2 - Tiny-Shell on Windows</h3>
<div class="level3">

<p>
Ne propunem să continuăm implementarea de <strong>Tiny-Shell</strong>.
</p>

<p>
<p><div class="noteimportant"> Compilarea se va realiza din Visual Studio sau din command-prompt-ul de Visual Studio (folosind utilitarul <code>nmake</code>), iar rularea executabilului <code>./2-tiny.exe</code> se va realiza din <strong>Cygwin</strong>.
</p>
<ul>
<li class="level1"><div class="li"> Dacă alegeți compilarea folosind Visual Studio, executabilul se numește <code>2-tiny.exe</code> și se găsește în calea <code>so/labs/lab03/skel/win/Debug</code>; </div>
</li>
<li class="level1"><div class="li"> Dacă alegeți compilarea folosind fișierul <code>Makefile</code> din calea <code>so/labs/lab03/skel/win/2-tiny</code>, executabilul se numește <code>tiny.exe</code> și se află în aceași locație ca fișierul <code>Makefile</code>.</div>
</li>
</ul>

<p>

</div></p>
</p>

</div>

<h4 id="a_executia_unei_comenzi_simple1">2a. Execuția unei comenzi simple</h4>
<div class="level4">

<p>
Partea de execuție a unei comenzi simple și a variabilelor de mediu este deja implementată.
</p>

<p>
Deschideți fișierul tiny.c din subproiectul 2-tiny.
Urmăriți în sursă funcția <code>RunSimpleCommand</code>. Testați funcționalitatea prin comenzi de tipul: 
</p>
<pre class="code bash"> .<span class="sy0">/</span><span class="nu0">2</span>-tiny.exe
<span class="sy0">&gt;</span> <span class="kw2">ls</span> <span class="re5">-al</span> 
<span class="sy0">&gt;</span> <span class="kw3">exit</span></pre>

</div>

<h4 id="b_redirectare">2b. Redirectare</h4>
<div class="level4">

<p>
Realizați redirectarea tuturor HANDLE-relor.
</p>

<p>
Completați funcția <code>RedirectHandle</code>.
</p>
<ul>
<li class="level1"><div class="li"> <strong>Atenție!</strong> Trebuie inițializate toate handle-rele structurii STARTUPINFO.</div>
</li>
<li class="level1"><div class="li"> Urmăriți în cod comentariile cu TODO 1.</div>
</li>
<li class="level1"><div class="li"> Revedeți secțiunea <a href="#mostenirea_handle-urilor_la_createprocess" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Moștenirea handle-urilor</a>.</div>
</li>
<li class="level1"><div class="li"> Atenție la metoda de moștenire a handle-relor</div>
</li>
</ul>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click to display ⇲
</p>
</div><div class="hiddenOnVisible">
<p>
Click to hide ⇱
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
După un apel <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a>, handle-urile din procesul părinte pot fi <strong>moștenite</strong> în procesul copil. 
</p>

<p>
Pentru ca un handle să poată fi moștenit în procesul creat, trebuie îndeplinite 2 condiții:
</p>
<ul>
<li class="level1"><div class="li"> membrul <code>bInheritHandle</code>, al structurii <code>SECURITY_ATTRIBUTES</code>, transmise lui <a href="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa363858%28VS.85%29.aspx"  rel="nofollow"> CreateFile</a>, trebuie să fie <code>TRUE</code></div>
</li>
<li class="level2"><div class="li"> parametrul <code>bInheritHandles</code>, al lui <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a>, trebuie să fie <code>TRUE</code>. </div>
</li>
<li class="level2"><div class="li"> atunci când se doreşte moştenierea handler-elor în procesul copil, trebuie să ne asigurăm că acestea sunt valide deorece în procesul copil nu se fac validări suplimentare. Transmiterea unor handlere invalide poate duce la un comportament nedefinit în procesul copil.</div>
</li>
</ul>

<p>
Pentru <strong>redirectarea</strong> handle-urilor standard în procesul copil:
</p>
<ul>
<li class="level1"><div class="li">  folosiți membrii <code>hStdInput</code>, <code>hStdOutput</code>, <code>hStdError</code> ai structurii <a href="http://msdn.microsoft.com/en-us/library/ms686331(v=VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms686331(v=VS.85).aspx"  rel="nofollow"> STARTUPINFO</a>, transmise lui <a href="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms682425%28VS.85%29.aspx"  rel="nofollow"> CreateProcess</a></div>
</li>
<li class="level1"><div class="li"> membrul <code>dwFlags</code> al aceleiași structuri trebuie setat la <code>STARTF_USESTDHANDLES</code></div>
</li>
<li class="level1"><div class="li"> dacă se dorește ca anumite handle-uri să rămână implicite, li se poate atribui handle-ul întors de <a href="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx"  rel="nofollow"> GetStdHandle</a>.</div>
</li>
</ul>
</div></div>
<p>
Pentru testare puteți folosi comenzile: 
</p>
<pre class="code bash"> .<span class="sy0">/</span><span class="nu0">2</span>-tiny.exe 
<span class="sy0">&gt;</span> <span class="kw2">ls</span> <span class="re5">-al</span> <span class="sy0">&gt;</span> out
<span class="sy0">&gt;</span> <span class="kw2">cat</span> out
<span class="sy0">&gt;</span> <span class="kw3">exit</span></pre>

</div>

<h4 id="c_implementarea_unei_comenzi_cu_pipe-uri">2c.  Implementarea unei comenzi cu pipe-uri</h4>
<div class="level4">

<p>
Shell-ul vostru trebuie să ofere suport pentru o comandă de forma &#039; comanda_simpla | comanda_simpla &#039;.
</p>

<p>
Urmăriți în cod comentariile cu TODO 2.
</p>
<ul>
<li class="level1"><div class="li"> Completați funcția <code>PipeCommands</code>.</div>
</li>
<li class="level1"><div class="li"> zeroizaţi structura <code>SECURITY_ATTRIBUTES sa</code>, respectiv structurile <code>PROCESS_INFO pi1, pi2</code>;</div>
</li>
<li class="level1"><div class="li"> <strong>Atenție! </strong> În procesul părinte, trebuie închise capetele pipe-urilor după ce nu mai sunt folosite.</div>
</li>
<li class="level1"><div class="li"> <strong>Atenție! </strong> membrul <code>bInheritHandle</code> al structurii <code>SECURITY_ATTRIBUTES</code>, transmise lui <code>CreatePipe</code>, trebuie să fie <code>TRUE</code>.</div>
</li>
<li class="level1"><div class="li"> Pentru redirectari, folosiți-vă de funcția <code>RedirectHandle</code>.</div>
</li>
<li class="level1"><div class="li"> Revedeți secțiunea despre <a href="#pipe-uri_anonime_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri anonime în Windows</a>.</div>
</li>
</ul>

<p>
Pentru testare puteți folosi comenzile: 
</p>
<pre class="code bash"> .<span class="sy0">/</span><span class="nu0">2</span>-tiny.exe
<span class="sy0">&gt;</span> <span class="kw2">cat</span> Makefile <span class="sy0">|</span> <span class="kw2">grep</span> tiny
<span class="sy0">&gt;</span> <span class="kw3">exit</span></pre>

</div>

<h3 class="sectionedit42" id="bonus">BONUS</h3>
<div class="level3">

</div>

<h5 id="pipe-uri_cu_nume_linuxwindows">Pipe-uri cu nume (Linux/Windows)</h5>
<div class="level5">

<p>
Realizați două programe, denumite <code>server</code> și <code>client</code>, care interacționează printr-un <strong>pipe cu nume</strong>.
</p>

<p>
FIFO−ul se numește <code>myfifo</code>. Dacă nu există, este creat de server.
</p>
<ul>
<li class="level1"><div class="li"> Serverul trebuie rulat înaintea clientului.</div>
</li>
<li class="level2"><div class="li"> Clientul citește de la intrarea standard un mesaj care va fi transmis serverului.</div>
</li>
<li class="level2"><div class="li"> Serverul va afișa mesajul primit la ieșirea standard.</div>
</li>
</ul>

<p>
Linux:
</p>
<ul>
<li class="level1"><div class="li"> Citiți secțiunea <a href="#pipe-uri_cu_nume_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri cu nume în Linux</a>.</div>
</li>
</ul>

<p>
Windows:
</p>
<ul>
<li class="level1"><div class="li"> Citiți secțiunea  <a href="#pipe-uri_cu_nume_in_windows" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri cu nume în Windows</a>.</div>
</li>
<li class="level2"><div class="li"> Puteți porni de la <a href="http://msdn.microsoft.com/en-us/library/aa365588.aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365588.aspx"  rel="nofollow">exemplul</a> din documentația <code>CreateNamedPipe</code>.</div>
</li>
<li class="level2"><div class="li"> <strong>Atenție</strong>: Dacă <code>ReadFile</code> întoarce FALSE, iar mesajul de eroare (ce întoarce GetLastError()) este <code>ERROR_BROKEN_PIPE</code>, înseamnă că au fost închise toate capetele de scriere.</div>
</li>
</ul>

</div>

<h5 id="magic_linux">Magic (Linux)</h5>
<div class="level5">

<p>
Intrați în directorul <code>lin/5-magic</code> și deschideți sursa <code>magic.c</code>
</p>

<p>
Completați <strong>doar</strong> condiția instrucțiunii <code>if</code> pentru a obține la rulare mesajul “Hello World”.
Încercați forțarea afișarea cuvântului “World” <strong>înainte</strong> de “Hello”.
Nu sunt permise alte modificări în funcția <code>main</code>.
</p>

</div>

<h5 id="pipe_fara_nume_linux">Pipe fără nume (Linux)</h5>
<div class="level5">

<p>
Intrați în directorul <code>lin/6-pipe</code> și deschideți sursa <code>pipe.c</code>
</p>

<p>
Programul este format din două procese, părinte și copil, care comunică prin intermediul unui pipe anonim. Părintele citește de la tastatură șiruri de caractere pe care apoi le pasează copilului printr-un capăt al unui pipe anonim. Copilul citește din celălalt capăt al pipe-ului anonim și afișează în consolă aceleași date. Practic, procesul copil scrie la consolă ce citește părintele de la tastatură.
</p>

<p>
Completați scheletul astfel încât să fie îndeplinită funcționalitatea de mai sus. 
</p>

<p>
Revedeți secțiunea <a href="#pipe-uri_anonime_in_linux" title="so:laboratoare:laborator-03 ↵" class="wikilink1">Pipe-uri anonime în Linux</a>.
</p>

<p>
Testați folosind:
</p>
<pre class="code bash"> .<span class="sy0">/</span>pipe
<span class="sy0">&gt;</span> Salut
<span class="sy0">&gt;</span> portocala
<span class="sy0">&gt;</span> <span class="kw3">exit</span></pre>

</div>

<h2 class="sectionedit43" id="resurse_utile">Resurse utile</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> <a href="http://en.wikipedia.org/wiki/Fork_(operating_system)" class="urlextern" title="http://en.wikipedia.org/wiki/Fork_(operating_system)"  rel="nofollow">Fork - Wikipedia</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www-h.eng.cam.ac.uk/help/tpl/unix/fork.html" class="urlextern" title="http://www-h.eng.cam.ac.uk/help/tpl/unix/fork.html"  rel="nofollow">About Fork and Exec</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html" class="urlextern" title="http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html"  rel="nofollow">Fork, Exec and Process Control - YoLinux Tutorial</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://en.wikibooks.org/wiki/Windows_Programming/Handles_and_Data_Types" class="urlextern" title="http://en.wikibooks.org/wiki/Windows_Programming/Handles_and_Data_Types"  rel="nofollow">Windows Handles and Data Types - Wikipedia</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/processes_and_threads.asp" class="urlextern" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/processes_and_threads.asp"  rel="nofollow">MSDN: Processes and Threads</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.goffconcepts.com/techarticles/development/cpp/createprocess.html" class="urlextern" title="http://www.goffconcepts.com/techarticles/development/cpp/createprocess.html"  rel="nofollow">C++ CreateProcess example</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://support.microsoft.com/kb/833721" class="urlextern" title="http://support.microsoft.com/kb/833721"  rel="nofollow">Windows XP and 2003 Server Boot.ini options</a></div>
</li>
</ol>

</div>
<div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
limită globală setată implicit pe Linux la 4096 bytes</div>
</div>

        </div>
        <div class="right_sidebar">
          <form action="/courses/start" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>          <div class="namespace_sidebar sidebar_box">



<h1 class="sectionedit1" id="informatii_generale_so">Informații generale SO</h1>
<div class="level1">

<div><div id="nojs_indexmenu_18803490363505a7d53131" data-jsajax="%26skipfile%3D%253D/so%253Ainfo%253Astart/" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="/courses/so/info/catalog" class="wikilink1" title="so:info:catalog">Catalog</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/documentatie" class="wikilink1" title="so:info:documentatie">Documentație și alte resurse</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/feed" class="wikilink1" title="so:info:feed">Feed RSS</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/hall" class="wikilink1" title="so:info:hall">Hall of SO</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/lista-discutii" class="wikilink1" title="so:info:lista-discutii">Listă de discuții</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/mv" class="wikilink1" title="so:info:mv">Mașini virtuale</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/info/trimitere-teme" class="wikilink1" title="so:info:trimitere-teme">Trimitere teme</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT1 SECTION "Informații generale SO" [12-194] -->
<h1 class="sectionedit2" id="informatii_so_2021-2022">Informații SO 2021-2022</h1>
<div class="level1">

<div><div id="nojs_indexmenu_209708925463505a7d55088" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="open"><div class="li"><a href="/courses/so/meta/examen" class="indexmenu_idx_head">Examen</a></div>
<ul class="idx">
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2012-2013" class="wikilink1" title="so:meta:examen:2012-2013">Examen CA/CC 2012-2013</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2013-2014" class="wikilink1" title="so:meta:examen:2013-2014">Examen CA/CC 2013-2014</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2014-2015" class="wikilink1" title="so:meta:examen:2014-2015">Examen CA/CC 2014-2015</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2015-2016" class="wikilink1" title="so:meta:examen:2015-2016">Examen CA/CC 2015-2016</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2016-2017" class="wikilink1" title="so:meta:examen:2016-2017">Examen CA/CB/CC 2016-2017</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2017-2018" class="wikilink1" title="so:meta:examen:2017-2018">Examen CA/CB/CC 2017-2018</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2018-2019" class="wikilink1" title="so:meta:examen:2018-2019">Examen CA/CB/CC 2018-2019</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2019-2020" class="wikilink1" title="so:meta:examen:2019-2020">Examen CA/CB/CC 2019-2020</a></div></li>
<li class="level2"><div class="li"><a href="/courses/so/meta/examen/2020-2021" class="wikilink1" title="so:meta:examen:2020-2021">Examen CA/CB/CC 2020-2021</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="/courses/so/meta/anunturi" class="wikilink1" title="so:meta:anunturi">Anunțuri</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/calendar" class="wikilink1" title="so:meta:calendar">Calendar</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/echivalari" class="wikilink1" title="so:meta:echivalari">Echivalări teme</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/hit_list" class="wikilink1" title="so:meta:hit_list">Distincții</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/karma" class="wikilink1" title="so:meta:karma">Karma Awards</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/need-to-know" class="wikilink1" title="so:meta:need-to-know">SO Need to Know</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/notare" class="wikilink1" title="so:meta:notare">Reguli generale și notare</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/meta/orar" class="wikilink1" title="so:meta:orar">Orar și împărțire pe semigrupe</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT2 SECTION "Informații SO 2021-2022" [195-261] -->
<h1 class="sectionedit3" id="laboratoare">Laboratoare</h1>
<div class="level1">

<p>
Accesibile pe GitHub, în <a href="https://github.com/open-education-hub/operating-systems-oer" class="urlextern" title="https://github.com/open-education-hub/operating-systems-oer"  rel="nofollow">organizația Open Education Hub</a>
</p>

</div>
<!-- EDIT3 SECTION "Laboratoare" [262-453] -->
<h1 class="sectionedit4" id="curs">Curs</h1>
<div class="level1">

<p>
Accesibile pe GitHub, în <a href="https://github.com/open-education-hub/operating-systems-oer" class="urlextern" title="https://github.com/open-education-hub/operating-systems-oer"  rel="nofollow">organizația Open Education Hub</a>
</p>

</div>
<!-- EDIT4 SECTION "Curs" [454-1442] -->
<h1 class="sectionedit5" id="teme">Teme</h1>
<div class="level1">

<div><div id="nojs_indexmenu_199605322363505a7d56fc9" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="closed"><div class="li"><a href="/courses/so/teme/tema-asist" class="indexmenu_idx_head">Tema Asistenți - Guardian process</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/contestatii" class="wikilink1" title="so:teme:contestatii">Contestații</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/folosire-gitlab" class="wikilink1" title="so:teme:folosire-gitlab">Git. Indicații folosire GitLab</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/general" class="wikilink1" title="so:teme:general">Indicații generale teme</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/hackathon" class="wikilink1" title="so:teme:hackathon">Hackathon SO</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/tema-1" class="wikilink1" title="so:teme:tema-1">Tema 1 Multi-platform Development</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/tema-2" class="wikilink1" title="so:teme:tema-2">Tema 2 Bibliotecă stdio</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/tema-3" class="wikilink1" title="so:teme:tema-3">Tema 3 Loader de Executabile</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/tema-4" class="wikilink1" title="so:teme:tema-4">Tema 4 Planificator de threaduri</a></div></li>
<li class="level1"><div class="li"><a href="/courses/so/teme/tema-5" class="wikilink1" title="so:teme:tema-5">Tema 5 Server web asincron</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT5 SECTION "Teme" [1443-] -->
</div>
<div class="toc_sidebar sidebar_box">
<!-- TOC START -->
<div id="sb__right__dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#laborator_03_-_procese">Laborator 03 - Procese</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#materiale_ajutatoare">Materiale ajutătoare</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#nice_to_read">Nice to read</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#link-uri_catre_sectiuni_utile">Link-uri către secțiuni utile</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#linux">Linux</a></div></li>
<li class="level3"><div class="li"><a href="#windows">Windows</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#prezentare_concepte">Prezentare concepte</a></div></li>
<li class="level2"><div class="li"><a href="#procese_in_linux">Procese în Linux</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#crearea_unui_proces_in_linux">Crearea unui proces în Linux</a></div></li>
<li class="level3"><div class="li"><a href="#inlocuirea_imaginii_unui_proces_in_linux">Înlocuirea imaginii unui proces în Linux</a></div></li>
<li class="level3"><div class="li"><a href="#asteptarea_terminarii_unui_proces_in_linux">Așteptarea terminării unui proces în Linux</a></div></li>
<li class="level3"><div class="li"><a href="#terminarea_unui_proces_in_linux">Terminarea unui proces în Linux</a></div></li>
<li class="level3"><div class="li"><a href="#exemplu_my_system">Exemplu (my_system)</a></div></li>
<li class="level3"><div class="li"><a href="#copierea_descriptorilor_de_fisier">Copierea descriptorilor de fișier</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="#mostenirea_descriptorilor_de_fisier_dupa_operatii_forkexec">Moștenirea descriptorilor de fișier după operații fork/exec</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#variabile_de_mediu_in_linux">Variabile de mediu în Linux</a></div></li>
<li class="level2"><div class="li"><a href="#pipe-uri_in_linux">Pipe-uri în Linux</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#pipe-uri_anonime_in_linux">Pipe-uri anonime în Linux</a></div></li>
<li class="level3"><div class="li"><a href="#pipe-uri_cu_nume_in_linux">Pipe-uri cu nume în Linux</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#depanarea_unui_proces">Depanarea unui proces</a></div></li>
<li class="level2"><div class="li"><a href="#procese_in_windows">Procese în Windows</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#crearea_unui_proces_in_windows">Crearea unui proces în Windows</a></div></li>
<li class="level3"><div class="li"><a href="#asteptarea_terminarii_unui_proces_in_windows">Așteptarea terminării unui proces în Windows</a></div></li>
<li class="level3"><div class="li"><a href="#aflarea_codului_de_terminare_a_procesului_asteptat_in_windows">Aflarea codului de terminare a procesului așteptat în Windows</a></div></li>
<li class="level3"><div class="li"><a href="#terminarea_unui_proces_in_windows">Terminarea unui proces în Windows</a></div></li>
<li class="level3"><div class="li"><a href="#exemplu">Exemplu</a></div></li>
<li class="level3"><div class="li"><a href="#mostenirea_handle-urilor_la_createprocess">Moștenirea handle-urilor la CreateProcess</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#variabile_de_mediu_in_windows">Variabile de mediu în Windows</a></div></li>
<li class="level2"><div class="li"><a href="#pipe-uri_in_windows">Pipe-uri în Windows</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#pipe-uri_anonime_in_windows">Pipe-uri anonime în Windows</a></div></li>
<li class="level3"><div class="li"><a href="#pipe-uri_cu_nume_in_windows">Pipe-uri cu nume în Windows</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="#mod_de_lucru_-_server_pipe">Mod de lucru - Server Pipe</a></div></li>
<li class="level4"><div class="li"><a href="#mod_de_lucru_-_client_pipe">Mod de lucru - Client Pipe</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#sumar">Sumar</a></div></li>
<li class="level2"><div class="li"><a href="#exercitii">Exerciții</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#exercitiul_0_-_stagii_pe_bune">Exercițiul 0 - Stagii pe bune</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#linux1">Linux</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#exercitiul_1_-_system">Exercițiul 1 - system</a></div></li>
<li class="level3"><div class="li"><a href="#exercitiul_2_-_orphan">Exercițiul 2 - orphan</a></div></li>
<li class="level3"><div class="li"><a href="#exercitiul_3_-_tiny-shell">Exercițiul 3 - Tiny-Shell</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="#a_executia_unei_comenzi_simple">3a. Execuția unei comenzi simple</a></div></li>
<li class="level4"><div class="li"><a href="#b_adaugare_suport_pentru_setarea_si_expandarea_variabilelor_de_mediu">3b. Adăugare suport pentru setarea și expandarea variabilelor de mediu</a></div></li>
<li class="level4"><div class="li"><a href="#c_redirectarea_iesirii_standard">3c. Redirectarea ieșirii standard</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#windows1">Windows</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#exercitiul_1_-_bomb">Exercițiul 1 - Bomb</a></div></li>
<li class="level3"><div class="li"><a href="#exercitiul_2_-_tiny-shell_on_windows">Exercițiul 2 - Tiny-Shell on Windows</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="#a_executia_unei_comenzi_simple1">2a. Execuția unei comenzi simple</a></div></li>
<li class="level4"><div class="li"><a href="#b_redirectare">2b. Redirectare</a></div></li>
<li class="level4"><div class="li"><a href="#c_implementarea_unei_comenzi_cu_pipe-uri">2c.  Implementarea unei comenzi cu pipe-uri</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="#bonus">BONUS</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#resurse_utile">Resurse utile</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
</div>
        </div>
      
    
      <div class="stylefoot">
        <div class="meta">
          <div class="user">
                    </div>
          <div class="doc">
          so/laboratoare/laborator-03.txt · Last modified: 2022/03/02 09:31 by teodor_stefan.dutu          </div>
        </div>
      </div>

    <div class="clearer"></div>

    
                <div class="bar" id="bar__bottom">
      <div class="bar-left">
        <a href="/courses/so/laboratoare/laborator-03?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]">Old revisions</a>      </div>
      <div class="bar-right">
        <a href="/courses/so/laboratoare/laborator-03?do=media&amp;ns=so%3Alaboratoare"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]">Back to top</a>      </div>
    </div>
    <div class="clearer"></div>
            
    <div align="center" class="footerinc">
  <div class="license"><a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="/courses/lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 3.0 Unported" /></a></div>
  <a target="_blank" href="http://www.chimeric.de" title="www.chimeric.de"><img src="/courses/lib/tpl/arctic/images/button-chimeric-de.png" width="80" height="15" alt="www.chimeric.de" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="/courses/lib/tpl/arctic/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="/courses/lib/tpl/arctic/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>

  <a target="_blank" href="http://www.firefox-browser.de" title="do yourself a favour and use a real browser - get firefox"><img src="/courses/lib/tpl/arctic/images/button-firefox.png" width="80" height="15" alt="do yourself a favour and use a real browser - get firefox!!" border="0" /></a>
  
  <a target="_blank" href="/courses/feed.php" title="Recent changes RSS feed"><img src="/courses/lib/tpl/arctic/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="/courses/lib/tpl/arctic/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>
</div>

  </div>
</div>

<div class="no"><img src="/courses/lib/exe/indexer.php?id=so%3Alaboratoare%3Alaborator-03&amp;1666210429" width="2" height="1" alt="" /></div>
</body>
</html>
